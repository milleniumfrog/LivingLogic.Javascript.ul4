{"version":3,"file":"ul4.js","sources":["../../src/ul4.ts"],"sourcesContent":["const _js_Date = Date;\ntype _js_date = Date;\n\nnamespace helpers {\n\t/**\n\t * checks if map exists when loading\n\t */\n\texport const _havemap: boolean = (typeof(Map) === \"function\" && typeof(Map.prototype.forEach) === \"function\");\n\t\n\t/**\n\t * checks if maps constructor exists when loading\n\t */\n    const _havemapconstructor: boolean = (function () {\n        if (_havemap)\n\t    {\n\t\t    try\n\t\t    {\n\t\t    \tif (new Map([[1, 2]]).size == 1)\n\t\t    \t\treturn true;\n\t\t    }\n\t\t    catch (error)\n\t\t    {\n\t\t    }\n        }\n        return false;\n\t})()\n\t\n\t/**\n\t * checks if set exists when loading\n\t */\n    const _haveset: boolean = (typeof(Set) === \"function\" && typeof(Set.prototype.forEach) === \"function\");\n\t\n\t/**\n\t * checks if set constructor exists when loading\n\t */\n\tconst _havesetconstructor: boolean = (function () {\n        if (_haveset)\n\t    {\n\t\t    try\n\t    \t{\n\t    \t\tif (new Set([1, 2]).size == 2)\n\t    \t\t\treturn true;\n\t    \t}\n\t\t    catch (error)\n\t\t    {\n\t\t    }\n        }\n        return false;\n\t})()\n\t\n\t/**\n\t * make a Maplike\n\t * @param {any[]} items \n\t */\n\tconst _makemap: (...items: any[]) => Map<any,any> | any = (function () {\n\t\tif( _havemap ) {\n\t\t\treturn function( ...items: any[] ) {\n\t\t\t\tlet map: Map<any,any> = new Map();\n\n\t\t\t\tfor (let [key, value] of items)\n\t\t\t\t\tmap.set(key, value);\n\t\t\t\treturn map;\t\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\treturn function( ...items: any[] ) {\n\t\t\t\tlet map: any = {};\n\n\t\t\t\tfor (let [key, value] of items)\n\t\t\t\t\tmap[key] = value;\n\t\t\t\treturn map;\n\t\t\t}\n\t\t}\n\t})()\n\t\n\t/**\n\t * set a value in a Maplike\n\t */\n\texport const _setmap: (map: Map<string, any> | any, key: string, value: any) => void = (function () {\n\t\tif( _havemap ) {\n\t\t\treturn function (map: Map<string, any>, key: string, value: any) {\n\t\t\t\tmap.set(key, value);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\treturn function( map: object, key: string, value: any) {\n\t\t\t\t(<any>map)[key] = value;\n\t\t\t}\n\t\t}\n\t})();\n\t/**\n\t * create empty Maplike\n\t */\n\texport const _emptymap: () => Map<string, any> | any = (function() {\n\t\tif( _havemap ) {\n\t\t\treturn function() {\n\t\t\t\treturn new Map();\n\t\t\t}\n\t\t} \n\t\telse {\n\t\t\treturn function() {\n\t\t\t\treturn <any>{};\n\t\t\t}\n\t\t}\n\t})()\n\t/**\n\t * get value for a key from a Maplike\n\t */\n\tconst _getmap: ( map: Map<string, any> |  any, key: string ) => any = (function() {\n\t\tif( _havemap ) {\n\t\t\treturn function( map: Map<string, any>, key: string) {\n\t\t\t\treturn map.get( key );\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\treturn function( map: any, key: string ) {\n\t\t\t\treturn map[key];\n\t\t\t}\n\t\t}\n\t})()\n\t/**\n\t * create empty Set\n\t */\n\texport const _emptyset: () => Set<any> | ul4._Set = (function() {\n\t\tif( _haveset ) {\n\t\t\treturn function () {\n\t\t\t\treturn new Set();\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\treturn function () {\n\t\t\t\treturn new ul4._Set();\n\t\t\t}\n\t\t}\n\t})()\n\t/**\n\t * make a set\n\t * @param {string[]} items\n\t */\n\texport function _makeset(...items: string[]) {\n\t\tlet set: Set<string> | ul4._Set = _emptymap();\n\t\tfor( let item of items ) {\n\t\t\tset.add( item );\n\t\t}\n\t\treturn set;\n\t}\n}\nexport namespace ul4 {\n\n\t// This is outside of ``Proto`` on purpose\n\t// This way reactive frameworks like ``Vue.js`` don't get to see it\n\t// and complain about mutating render functions when those create new objects.\n\tlet _nextid: number = 1;\n\n\t// --FUNCTIONS--\n\n\texport function _update( obj: any, others: any, kwargs: any ): any {\n\t\tif (!ul4._isdict(obj))\n\t\t\tthrow new ul4.TypeError(\"update() requires a dict\");\n\t\tfor (let other of others)\n\t\t{\n\t\t\tif (ul4._ismap(other))\n\t\t\t{\n\t\t\t\tother.forEach(function(value: any, key: string){\n\t\t\t\t\thelpers._setmap(obj, key, value);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (ul4._isobject(other))\n\t\t\t{\n\t\t\t\tfor (let key in other)\n\t\t\t\t\thelpers._setmap(obj, key, other[key]);\n\t\t\t}\n\t\t\telse if (ul4._islist(other))\n\t\t\t{\n\t\t\t\tfor (let item of other)\n\t\t\t\t{\n\t\t\t\t\tif (!ul4._islist(item) || (item.length != 2))\n\t\t\t\t\t\tthrow new ul4.TypeError(\"update() requires a dict or a list of (key, value) pairs\");\n\t\t\t\t\thelpers._setmap(obj, item[0], item[1]);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t\tthrow new ul4.TypeError(\"update() requires a dict or a list of (key, value) pairs\");\n\t\t}\n\t\tkwargs.forEach(function(value: any, key: any) {\n\t\t\thelpers._setmap(obj, key, value);\n\t\t});\n\t\treturn null;\n\t}\n\n\t/**\n\t * Return a ``Color`` object from the hue, luminescence, saturation and alpha values ``h``, ``l``, ``s`` and ``a`` (i.e. using the HLS color model)\n\t */\n\texport function _hls( h: number, l: number, s: number, a: number ) {\n\t\tlet _v = function(m1: any, m2: any, hue:any)\n\t\t{\n\t\t\thue = hue % 1.0;\n\t\t\tif (hue < 1/6)\n\t\t\t\treturn m1 + (m2-m1)*hue*6.0;\n\t\t\telse if (hue < 0.5)\n\t\t\t\treturn m2;\n\t\t\telse if (hue < 2/3)\n\t\t\t\treturn m1 + (m2-m1)*(2/3-hue)*6.0;\n\t\t\treturn m1;\n\t\t};\n\n\t\tlet m1, m2;\n\t\tif (typeof(a) === \"undefined\")\n\t\t\ta = 1;\n\t\tif (s === 0.0)\n\t\t\treturn ul4._rgb(l, l, l, a);\n\t\tif (l <= 0.5)\n\t\t\tm2 = l * (1.0+s);\n\t\telse\n\t\t\tm2 = l+s-(l*s);\n\t\tm1 = 2.0*l - m2;\n\t\treturn ul4._rgb(_v(m1, m2, h+1/3), _v(m1, m2, h), _v(m1, m2, h-1/3), a);\n\t}\n\n\t/**\n\t * Create a color object from the red, green, blue and alpha values ``r``, ``g``, ``b`` and ``a``\n\t * @param r \n\t * @param g \n\t * @param b \n\t * @param a \n\t */\n\texport function _rgb( r: number, g: number, b:number, a: number ) {\n\t\treturn new ul4.Color(255*r, 255*g, 255*b, 255*a);\n\t}\n\n\t/**\n\t * Return a ``Date`` object from the arguments passed in \n\t * @param year \n\t * @param month \n\t * @param day \n\t */\n\texport function _date( year: number, month: number, day: number )  {\n\t\treturn new ul4.Date(year, month, day);\n\t}\n\n\texport function _isleap( obj: any ) {\n\t\treturn new _js_Date(obj.getFullYear(), 1, 29).getMonth() === 1;\n\t}\n\n\texport function _formatsource( out: string[] ) {\n\t\tlet finalout = [];\n\t\tlet level = 0, needlf = false;\n\t\tfor (let part of out)\n\t\t{\n\t\t\tif (typeof(part) === \"number\")\n\t\t\t{\n\t\t\t\tlevel += part;\n\t\t\t\tneedlf = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (needlf)\n\t\t\t\t{\n\t\t\t\t\tfinalout.push(\"\\n\");\n\t\t\t\t\tfor (let j = 0; j < level; ++j)\n\t\t\t\t\t\tfinalout.push(\"\\t\");\n\t\t\t\t\tneedlf = false;\n\t\t\t\t}\n\t\t\t\tfinalout.push(part);\n\t\t\t}\n\t\t}\n\t\tif (needlf)\n\t\t\tfinalout.push(\"\\n\");\n\t\treturn finalout.join(\"\");\n\t}\n\n\t/**\n\t * (this is non-trivial, because it follows the Python semantic of ``-5 % 2`` being ``1``)\n\t * @param obj1 \n\t * @param obj2 \n\t */\n\texport function _mod( obj1: number, obj2: number ) {\n\t\tlet div = Math.floor(obj1 / obj2);\n\t\tlet mod = obj1 - div * obj2;\n\n\t\tif (mod !== 0 && ((obj2 < 0 && mod > 0) || (obj2 > 0 && mod < 0)))\n\t\t{\n\t\t\tmod += obj2;\n\t\t\t--div;\n\t\t}\n\t\treturn obj1 - div * obj2;\n\t}\n\n\texport function _unorderable( operator: string, obj1: any, obj2: any ) {\n\t\tthrow new ul4.TypeError(\"unorderable types: \" + ul4._type(obj1) + \" \" + operator + \" \" + ul4._type(obj2));\n\t}\n\n\texport function expose( f: any, signature: any, options?: any ) {\n\t\toptions = options || {};\n\t\tif (options.name)\n\t\t\tf._ul4_name = options.name;\n\t\tif (ul4._islist(signature))\n\t\t\tsignature = new ul4.Signature(...signature);\n\t\tf._ul4_signature = signature;\n\t\tf._ul4_needsobject = options.needsobject || false;\n\t\tf._ul4_needscontext = options.needscontext || false;\n\t}\n\n\texport function _find( obj: any, sub: any,  start: number | null = null, end: number | null = null ) {\n\t\tif (start === null)\n\t\t\tstart = 0;\n\t\tif (end === null)\n\t\t\tend = <number>obj.length || 0;\n\t\t\n\t\tif (start < 0)\n\t\t\tstart += obj.length;\n\t\tif (end < 0)\n\t\t\tend += obj.length;\n\t\tstart = ul4._bound(start, obj.length);\n\t\tend = ul4._bound(end, obj.length);\n\n\t\tif (start !== 0 || end !== obj.length)\n\t\t{\n\t\t\tif (typeof(obj) == \"string\")\n\t\t\t\tobj = obj.substring(start, end);\n\t\t\telse\n\t\t\t\tobj = obj.slice(start, end);\n\t\t}\n\t\tlet result = obj.indexOf(sub);\n\t\tif (result !== -1)\n\t\t\tresult += start;\n\t\treturn result;\n\t}\n\n\texport function _eq( obj1: any, obj2: any ): boolean {\n\t\tlet numbertypes: string[] = [ \"boolean\", \"number\" ];\n\t\tif( obj1 && typeof( obj1.__eq__ ) === \"function\" )\n\t\t\treturn obj1.__eq__(obj2);\n\t\telse if (obj2 && typeof(obj2.__eq__) === \"function\")\n\t\t\treturn obj2.__eq__(obj1);\n\t\telse if (obj1 === null)\n\t\t\treturn obj2 === null;\n\t\telse if (numbertypes.indexOf(typeof(obj1)) != -1) {\n\t\t\tif (numbertypes.indexOf(typeof(obj2)) != -1)\n\t\t\t\treturn obj1 == obj2;\n\t\t\telse\n\t\t\t\treturn false;\n\t\t}\n\t\telse if (typeof(obj1) === \"string\") {\n\t\t\tif (typeof(obj2) === \"string\")\n\t\t\t\treturn obj1 == obj2;\n\t\t\telse\n\t\t\t\treturn false;\n\t\t}\n\t\telse if (ul4._isdatetime(obj1))\n\t\t{\n\t\t\tif (ul4._isdatetime(obj2))\n\t\t\t\treturn obj1.getTime() == obj2.getTime();\n\t\t\telse\n\t\t\t\treturn false;\n\t\t}\n\t\telse if (ul4._islist(obj1))\n\t\t{\n\t\t\tif (ul4._islist(obj2))\n\t\t\t{\n\t\t\t\t// Shortcut, if it's the same object\n\t\t\t\tif (obj1 === obj2)\n\t\t\t\t\treturn true;\n\t\t\t\tif (obj1.length != obj2.length)\n\t\t\t\t\treturn false;\n\t\t\t\tfor (let i = 0; i < obj1.length; ++i)\n\t\t\t\t{\n\t\t\t\t\tif (!ul4._eq(obj1[i], obj2[i])) // This might lead to infinite recursion and a stackoverflow, but it does in all implementations\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t\treturn false;\n\t\t}\n\t\telse if (ul4._isobject(obj1))\n\t\t{\n\t\t\tif (ul4._isobject(obj2))\n\t\t\t{\n\t\t\t\t// Shortcut, if it's the same object\n\t\t\t\tif (obj1 === obj2)\n\t\t\t\t\treturn true;\n\t\t\t\t// Test that each attribute of ``obj1`` can also be found in ``obj2`` and has the same value\n\t\t\t\tfor (let key in obj1)\n\t\t\t\t{\n\t\t\t\t\tif (obj2.hasOwnProperty(key))\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!ul4._eq(obj1[key], obj2[key]))\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t// Test that each attribute of ``obj2`` is alos in ``obj1`` (the value has been tested before)\n\t\t\t\tfor (let key in obj2)\n\t\t\t\t{\n\t\t\t\t\tif (!obj1.hasOwnProperty(key))\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse if (ul4._ismap(obj2))\n\t\t\t{\n\t\t\t\t// Test that each attribute of ``obj1`` can also be found in ``obj2`` and has the same value\n\t\t\t\tfor (let key in obj1)\n\t\t\t\t{\n\t\t\t\t\tif (obj2.has(key))\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!ul4._eq(obj1[key], obj2.get(key)))\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t// Test that each attribute of ``obj2`` is alos in ``obj1`` (the value has been tested before)\n\t\t\t\tlet result = true;\n\t\t\t\tobj2.forEach(function(value: any, key: any){\n\t\t\t\t\tif (!obj1.hasOwnProperty(key))\n\t\t\t\t\t\tresult = false;\n\t\t\t\t});\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\telse\n\t\t\t\treturn false;\n\t\t}\n\t\telse if (ul4._ismap(obj1))\n\t\t{\n\t\t\tif (ul4._isobject(obj2))\n\t\t\t{\n\t\t\t\t// Test that each attribute of ``obj1`` can also be found in ``obj2`` and has the same value\n\t\t\t\tlet result = true;\n\t\t\t\tobj1.forEach(function(value: any, key: any){\n\t\t\t\t\tif (result) // Skip code, if result is already ``false``\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!obj2.hasOwnProperty(key))\n\t\t\t\t\t\t\tresult = false;\n\t\t\t\t\t\telse if (!ul4._eq(obj1.get(key), obj2[key]))\n\t\t\t\t\t\t\tresult = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (!result)\n\t\t\t\t\treturn false;\n\t\t\t\t// Test that each attribute of ``obj2`` is alos in ``obj1`` (the value has been tested before)\n\t\t\t\tfor (let key in obj2)\n\t\t\t\t{\n\t\t\t\t\tif (!obj1.has(key))\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse if (ul4._ismap(obj2))\n\t\t\t{\n\t\t\t\t// Shortcut, if it's the same object\n\t\t\t\tif (obj1 === obj2)\n\t\t\t\t\treturn true;\n\t\t\t\tif (obj1.size != obj2.size)\n\t\t\t\t\treturn false;\n\t\t\t\t// Test that each attribute of ``obj1`` can also be found in ``obj2`` and has the same value\n\t\t\t\tlet result = true;\n\t\t\t\tobj1.forEach(function(value: any, key: any){\n\t\t\t\t\tif (result) // Skip code, if result is already ``false``\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!obj2.has(key))\n\t\t\t\t\t\t\tresult = false;\n\t\t\t\t\t\telse if (!ul4._eq(obj1.get(key), obj2.get(key)))\n\t\t\t\t\t\t\tresult = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\telse\n\t\t\t\treturn false;\n\t\t}\n\t\telse if (ul4._isset(obj1))\n\t\t{\n\t\t\t// We don't have to test for ``ul4._Set`` as ``ul4._Set`` implements ``__eq__``\n\t\t\tif (ul4._isset(obj2))\n\t\t\t{\n\t\t\t\t// Shortcut, if it's the same object\n\t\t\t\tif (obj1 === obj2)\n\t\t\t\t\treturn true;\n\t\t\t\tif (obj1.size != obj2.size)\n\t\t\t\t\treturn false;\n\t\t\t\tlet result = true;\n\t\t\t\tobj1.forEach(function(value: any){\n\t\t\t\t\tif (result) // Skip code, if result is already ``false``\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!obj2.has(value))\n\t\t\t\t\t\t\tresult = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\telse\n\t\t\t\treturn false;\n\t\t}\n\t\telse\n\t\t\treturn obj1 === obj2;\n\t}\n\n\t/**\n\t * Clip a number to the range [0;max)\n\t * @param value \n\t * @param upper \n\t */\n\texport function _bound( value: number, upper: number ): number {\n\t\tif (value < 0)\n\t\t\treturn 0;\n\t\telse if (value > upper)\n\t\t\treturn upper;\n\t\telse\n\t\t\treturn value;\n\n\t}\n\n\texport function _count(obj: any, sub: any, start: number | null =null, end: number | null =null)\n\t{\n\t\tif (start === null)\n\t\t\tstart = 0;\n\t\tif (start < 0)\n\t\t\tstart += obj.length;\n\n\t\tif (end === null)\n\t\t\tend = obj.length || 0;\n\t\tif (<number>end < 0)\n\t\t\tend += obj.length;\n\t\t// cast end to number\n\t\tlet isstr = ul4._isstr(obj);\n\n\t\tif (isstr && !sub.length)\n\t\t{\n\t\t\tif (<number>end < 0 || start > obj.length || start > <number>end)\n\t\t\t\treturn 0;\n\t\t\tlet result = <number>end - start + 1;\n\t\t\tif (result > obj.length + 1)\n\t\t\t\tresult = obj.length + 1;\n\t\t\treturn result;\n\t\t}\n\n\t\tstart = ul4._bound(start, obj.length);\n\t\tend = ul4._bound(<number>end, obj.length);\n\n\t\tlet count = 0;\n\t\tif (ul4._islist(obj))\n\t\t{\n\t\t\tfor (let i = start; (<number>i) < (<number>end); ++(<number>i))\n\t\t\t{\n\t\t\t\tif (ul4._eq(obj[(<number>i)], sub))\n\t\t\t\t\t++count;\n\t\t\t}\n\t\t\treturn count;\n\t\t}\n\t\telse // string\n\t\t{\n\t\t\tlet lastIndex = start;\n\n\t\t\tfor (;;)\n\t\t\t{\n\t\t\t\tlastIndex = obj.indexOf(sub, lastIndex);\n\t\t\t\tif (lastIndex == -1)\n\t\t\t\t\tbreak;\n\t\t\t\tif (lastIndex + sub.length > <number>end)\n\t\t\t\t\tbreak;\n\t\t\t\t++count;\n\t\t\t\tlastIndex += sub.length;\n\t\t\t}\n\t\t\treturn count;\n\t\t}\n\t};\n\n\texport function _isul4set( obj: any ): boolean {\n\t\treturn (obj instanceof ul4._Set);\n\t}\n\t/**\n\t * check if type is string\n\t * @param obj \n\t */\n\texport function _isstr( obj: any ): boolean {\n\t\treturn typeof( obj ) === \"string\";\n\t}\n\n\t/**\n\t * Check if ``obj`` is a color\n\t * @param obj \n\t */\n\texport function _iscolor( obj: any ): boolean {\n\t\treturn (obj instanceof ul4.Color);\n\t}\n\n\texport function _isdate( obj: any ): boolean {\n\t\treturn (obj instanceof ul4.Date);\n\t}\n\n\texport function _isdatetime( obj: any ): boolean {\n\t\treturn Object.prototype.toString.call(obj) == \"[object Date]\";\n\t}\n\n\t/**\n\t * Check if ``obj`` is a timedelta object\n\t * @param obj \n\t */\n\texport function _istimedelta( obj: any ): boolean {\n\t\treturn (obj instanceof ul4.TimeDelta);\n\t}\n\n\t/**\n\t * Check if ``obj`` is a monthdelta object\n\t * @param obj \n\t */\n\texport function _ismonthdelta( obj: any ): boolean {\n\t\treturn (obj instanceof ul4.MonthDelta);\n\t}\n\n\texport function _islist( obj: any ): boolean {\n\t\treturn Object.prototype.toString.call(obj) == \"[object Array]\";\n\t}\n\n\texport function _ismap( obj: any ): boolean {\n\t\treturn obj !== null && typeof(obj) === \"object\" && typeof(obj.__proto__) === \"object\" && obj.__proto__ === Map.prototype;\n\t}\n\n\texport function _isdict( obj: any ): boolean {\n\t\treturn ul4._isobject(obj) || ul4._ismap(obj);\n\t}\n\n\texport function _isset( obj: any ): boolean {\n\t\treturn Object.prototype.toString.call(obj) == \"[object Set]\";\n\t}\n\n\texport function _isobject( obj: any ): boolean {\n\t\treturn Object.prototype.toString.call(obj) == \"[object Object]\" && typeof(obj.__type__) === \"undefined\" && !(obj instanceof ul4.Proto);\n\t}\n\n\texport function _isiter( obj: any ): boolean {\n\t\treturn obj !== null && typeof(obj) === \"object\" && typeof(obj.next) === \"function\";\n\t}\n\n\t/**\n\t * Return a string representation of ``obj``: If possible this should be an object literal supported by UL4, otherwise the output should be bracketed with ``<`` and ``>``\n\t * @param obj \n\t */\n\texport function _repr( obj: any ): string {\n\t\treturn ul4._repr_internal( obj, false );\n\t}\n\n\texport function _repr_internal( obj: any, ascii:boolean ) {\n\t\tif (obj === null)\n\t\t\treturn \"None\";\n\t\telse if (obj === false)\n\t\t\treturn \"False\";\n\t\telse if (obj === true)\n\t\t\treturn \"True\";\n\t\telse if (typeof(obj) === \"string\")\n\t\t\treturn ul4._str_repr(obj, ascii);\n\t\telse if (typeof(obj) === \"number\")\n\t\t\treturn \"\" + obj;\n\t\telse if (typeof(obj) === \"function\")\n\t\t\tif (obj._ul4_name || obj.name)\n\t\t\t\treturn \"<function \" + (obj._ul4_name || obj.name) + \">\";\n\t\t\telse\n\t\t\t\treturn \"<anonymous function>\";\n\t\telse if (ul4._isdate(obj))\n\t\t\treturn ul4._date_repr(obj, ascii);\n\t\telse if (ul4._isdatetime(obj))\n\t\t\treturn ul4._datetime_repr(obj, ascii);\n\t\telse if (typeof(obj) === \"undefined\")\n\t\t\treturn \"<undefined>\";\n\t\telse if (typeof(obj) === \"object\" && typeof(obj.__repr__) === \"function\")\n\t\t\treturn obj.__repr__();\n\t\telse if (ul4._islist(obj))\n\t\t\treturn ul4._list_repr(obj, ascii);\n\t\telse if (ul4._ismap(obj))\n\t\t\treturn ul4._map_repr(obj, ascii);\n\t\telse if (ul4._isset(obj))\n\t\t\treturn ul4._set_repr(obj, ascii);\n\t\telse if (ul4._isobject(obj))\n\t\t\treturn ul4._object_repr(obj, ascii);\n\t\treturn \"?\";\n\t}\n\n\texport function _object_repr( obj: any, ascii: boolean = false ): string {\n\t\tlet v = [];\n\t\tv.push(\"{\");\n\t\tlet i = 0;\n\t\tfor (let key in obj)\n\t\t{\n\t\t\tif (!obj.hasOwnProperty(key))\n\t\t\t\tcontinue;\n\t\t\tif (i++)\n\t\t\t\tv.push(\", \");\n\t\t\tv.push(ul4._repr_internal(key, ascii));\n\t\t\tv.push(\": \");\n\t\t\tv.push(ul4._repr_internal(obj[key], ascii));\n\t\t}\n\t\tv.push(\"}\");\n\t\treturn v.join(\"\");\n\t}\n\n\texport function _set_repr( obj: any, ascii: boolean = false ): string {\n\t\tlet v: any[] = [];\n\t\tv.push(\"{\");\n\t\tif (!obj.size)\n\t\t\tv.push(\"/\");\n\t\telse\n\t\t{\n\t\t\tlet i = 0;\n\t\t\tobj.forEach(function(value: any, key: any){\n\t\t\t\tif (i++)\n\t\t\t\t\tv.push(\", \");\n\t\t\t\tv.push(ul4._repr_internal(value, ascii));\n\t\t\t});\n\t\t}\n\t\tv.push(\"}\");\n\t\treturn v.join(\"\");\n\t}\n\n\texport function _map_repr( obj: any, ascii: boolean = false ): string {\n\t\tlet v: any[] = [];\n\t\tv.push(\"{\");\n\n\t\tlet i = 0;\n\t\tobj.forEach(function(value: any, key: any){\n\t\t\tif (i++)\n\t\t\t\tv.push(\", \");\n\t\t\tv.push(ul4._repr_internal(key, ascii));\n\t\t\tv.push(\": \");\n\t\t\tv.push(ul4._repr_internal(value, ascii));\n\t\t});\n\n\t\tv.push(\"}\");\n\t\treturn v.join(\"\");\n\n\t}\n\n\texport function _list_repr( obj: any, ascii: boolean = false ): string {\n\t\tlet v: any[] = [];\n\t\tv.push(\"[\");\n\t\tfor (let i = 0; i < obj.length; ++i)\n\t\t{\n\t\t\tif (i !== 0)\n\t\t\t\tv.push(\", \");\n\t\t\tv.push(ul4._repr_internal(obj[i], ascii));\n\t\t}\n\t\tv.push(\"]\");\n\t\treturn v.join(\"\");\n\n\t}\n\n\texport function _datetime_repr( obj: any, ascii: boolean = false ): string {\n\t\tlet year = obj.getFullYear();\n\t\tlet month = obj.getMonth()+1;\n\t\tlet day = obj.getDate();\n\t\tlet hour = obj.getHours();\n\t\tlet minute = obj.getMinutes();\n\t\tlet second = obj.getSeconds();\n\t\tlet ms = obj.getMilliseconds();\n\t\tlet result = \"@(\" + year + \"-\" + ul4._lpad(month.toString(), \"0\", 2) + \"-\" + ul4._lpad(day.toString(), \"0\", 2) + \"T\";\n\n\t\tif (hour || minute || second || ms)\n\t\t{\n\t\t\tresult += ul4._lpad(hour.toString(), \"0\", 2) + \":\" + ul4._lpad(minute.toString(), \"0\", 2);\n\t\t\tif (second || ms)\n\t\t\t{\n\t\t\t\tresult += \":\" + ul4._lpad(second.toString(), \"0\", 2)\n\t\t\t\tif (ms)\n\t\t\t\t\tresult += \".\" + ul4._lpad(ms.toString(), \"0\", 3) + \"000\";\n\t\t\t}\n\t\t}\n\t\tresult += \")\";\n\n\t\treturn result;\n\n\t}\n\n\texport function _date_repr( obj: any, ascii: boolean = false ): string {\n\t\tlet date = <_js_date>obj._date;\n\t\tlet year: number = date.getFullYear();\n\t\tlet month: number = date.getMonth()+1;\n\t\tlet day: number = date.getDate();\n\t\tlet result = \"@(\" + year + \"-\" + ul4._lpad(month.toString(), \"0\", 2) + \"-\" + ul4._lpad(day.toString(), \"0\", 2) + \")\";\n\t\treturn result;\n\n\t}\n\n\texport function _str_repr( str: string, ascii: boolean = false ): string {\n\t\tlet result: string = \"\";\n\t\tlet squote: boolean = false, dquote: boolean = false;\n\n\t\tfor (let c of str)\n\t\t{\n\t\t\tif (c == '\"')\n\t\t\t{\n\t\t\t\tdquote = true;\n\t\t\t\tif (squote)\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse if (c == \"'\")\n\t\t\t{\n\t\t\t\tsquote = true;\n\t\t\t\tif (dquote)\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t// Prefer single quotes: Only use double quotes if the string contains single quotes, but no double quotes\n\t\tlet quote = (squote && !dquote) ? '\"' : \"'\";\n\n\t\tfor (let c of str)\n\t\t{\n\t\t\tswitch (c)\n\t\t\t{\n\t\t\t\tcase '\"':\n\t\t\t\t\tresult += (quote == c) ? '\\\\\"' : c;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"'\":\n\t\t\t\t\tresult += (quote == c) ? \"\\\\'\" : c;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"\\\\\":\n\t\t\t\t\tresult += \"\\\\\\\\\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"\\t\":\n\t\t\t\t\tresult += \"\\\\t\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"\\n\":\n\t\t\t\t\tresult += \"\\\\n\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"\\r\":\n\t\t\t\t\tresult += \"\\\\r\";\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tlet code: number = c.charCodeAt(0);\n\t\t\t\t\tlet escape;\n\t\t\t\t\tif (code < 32)\n\t\t\t\t\t\tescape = 2;\n\t\t\t\t\telse if (code < 0x7f)\n\t\t\t\t\t\tescape = 0;\n\t\t\t\t\telse if (!ascii && !/[\\u007f-\\u00a0\\u00ad\\u0378-\\u0379\\u0380-\\u0383\\u038b\\u038d\\u03a2\\u0530\\u0557-\\u0558\\u0560\\u0588\\u058b-\\u058c\\u0590\\u05c8-\\u05cf\\u05eb-\\u05ef\\u05f5-\\u0605\\u061c-\\u061d\\u06dd\\u070e-\\u070f\\u074b-\\u074c\\u07b2-\\u07bf\\u07fb-\\u07ff\\u082e-\\u082f\\u083f\\u085c-\\u085d\\u085f-\\u089f\\u08b5-\\u08e2\\u0984\\u098d-\\u098e\\u0991-\\u0992\\u09a9\\u09b1\\u09b3-\\u09b5\\u09ba-\\u09bb\\u09c5-\\u09c6\\u09c9-\\u09ca\\u09cf-\\u09d6\\u09d8-\\u09db\\u09de\\u09e4-\\u09e5\\u09fc-\\u0a00\\u0a04\\u0a0b-\\u0a0e\\u0a11-\\u0a12\\u0a29\\u0a31\\u0a34\\u0a37\\u0a3a-\\u0a3b\\u0a3d\\u0a43-\\u0a46\\u0a49-\\u0a4a\\u0a4e-\\u0a50\\u0a52-\\u0a58\\u0a5d\\u0a5f-\\u0a65\\u0a76-\\u0a80\\u0a84\\u0a8e\\u0a92\\u0aa9\\u0ab1\\u0ab4\\u0aba-\\u0abb\\u0ac6\\u0aca\\u0ace-\\u0acf\\u0ad1-\\u0adf\\u0ae4-\\u0ae5\\u0af2-\\u0af8\\u0afa-\\u0b00\\u0b04\\u0b0d-\\u0b0e\\u0b11-\\u0b12\\u0b29\\u0b31\\u0b34\\u0b3a-\\u0b3b\\u0b45-\\u0b46\\u0b49-\\u0b4a\\u0b4e-\\u0b55\\u0b58-\\u0b5b\\u0b5e\\u0b64-\\u0b65\\u0b78-\\u0b81\\u0b84\\u0b8b-\\u0b8d\\u0b91\\u0b96-\\u0b98\\u0b9b\\u0b9d\\u0ba0-\\u0ba2\\u0ba5-\\u0ba7\\u0bab-\\u0bad\\u0bba-\\u0bbd\\u0bc3-\\u0bc5\\u0bc9\\u0bce-\\u0bcf\\u0bd1-\\u0bd6\\u0bd8-\\u0be5\\u0bfb-\\u0bff\\u0c04\\u0c0d\\u0c11\\u0c29\\u0c3a-\\u0c3c\\u0c45\\u0c49\\u0c4e-\\u0c54\\u0c57\\u0c5b-\\u0c5f\\u0c64-\\u0c65\\u0c70-\\u0c77\\u0c80\\u0c84\\u0c8d\\u0c91\\u0ca9\\u0cb4\\u0cba-\\u0cbb\\u0cc5\\u0cc9\\u0cce-\\u0cd4\\u0cd7-\\u0cdd\\u0cdf\\u0ce4-\\u0ce5\\u0cf0\\u0cf3-\\u0d00\\u0d04\\u0d0d\\u0d11\\u0d3b-\\u0d3c\\u0d45\\u0d49\\u0d4f-\\u0d56\\u0d58-\\u0d5e\\u0d64-\\u0d65\\u0d76-\\u0d78\\u0d80-\\u0d81\\u0d84\\u0d97-\\u0d99\\u0db2\\u0dbc\\u0dbe-\\u0dbf\\u0dc7-\\u0dc9\\u0dcb-\\u0dce\\u0dd5\\u0dd7\\u0de0-\\u0de5\\u0df0-\\u0df1\\u0df5-\\u0e00\\u0e3b-\\u0e3e\\u0e5c-\\u0e80\\u0e83\\u0e85-\\u0e86\\u0e89\\u0e8b-\\u0e8c\\u0e8e-\\u0e93\\u0e98\\u0ea0\\u0ea4\\u0ea6\\u0ea8-\\u0ea9\\u0eac\\u0eba\\u0ebe-\\u0ebf\\u0ec5\\u0ec7\\u0ece-\\u0ecf\\u0eda-\\u0edb\\u0ee0-\\u0eff\\u0f48\\u0f6d-\\u0f70\\u0f98\\u0fbd\\u0fcd\\u0fdb-\\u0fff\\u10c6\\u10c8-\\u10cc\\u10ce-\\u10cf\\u1249\\u124e-\\u124f\\u1257\\u1259\\u125e-\\u125f\\u1289\\u128e-\\u128f\\u12b1\\u12b6-\\u12b7\\u12bf\\u12c1\\u12c6-\\u12c7\\u12d7\\u1311\\u1316-\\u1317\\u135b-\\u135c\\u137d-\\u137f\\u139a-\\u139f\\u13f6-\\u13f7\\u13fe-\\u13ff\\u1680\\u169d-\\u169f\\u16f9-\\u16ff\\u170d\\u1715-\\u171f\\u1737-\\u173f\\u1754-\\u175f\\u176d\\u1771\\u1774-\\u177f\\u17de-\\u17df\\u17ea-\\u17ef\\u17fa-\\u17ff\\u180e-\\u180f\\u181a-\\u181f\\u1878-\\u187f\\u18ab-\\u18af\\u18f6-\\u18ff\\u191f\\u192c-\\u192f\\u193c-\\u193f\\u1941-\\u1943\\u196e-\\u196f\\u1975-\\u197f\\u19ac-\\u19af\\u19ca-\\u19cf\\u19db-\\u19dd\\u1a1c-\\u1a1d\\u1a5f\\u1a7d-\\u1a7e\\u1a8a-\\u1a8f\\u1a9a-\\u1a9f\\u1aae-\\u1aaf\\u1abf-\\u1aff\\u1b4c-\\u1b4f\\u1b7d-\\u1b7f\\u1bf4-\\u1bfb\\u1c38-\\u1c3a\\u1c4a-\\u1c4c\\u1c80-\\u1cbf\\u1cc8-\\u1ccf\\u1cf7\\u1cfa-\\u1cff\\u1df6-\\u1dfb\\u1f16-\\u1f17\\u1f1e-\\u1f1f\\u1f46-\\u1f47\\u1f4e-\\u1f4f\\u1f58\\u1f5a\\u1f5c\\u1f5e\\u1f7e-\\u1f7f\\u1fb5\\u1fc5\\u1fd4-\\u1fd5\\u1fdc\\u1ff0-\\u1ff1\\u1ff5\\u1fff-\\u200f\\u2028-\\u202f\\u205f-\\u206f\\u2072-\\u2073\\u208f\\u209d-\\u209f\\u20bf-\\u20cf\\u20f1-\\u20ff\\u218c-\\u218f\\u23fb-\\u23ff\\u2427-\\u243f\\u244b-\\u245f\\u2b74-\\u2b75\\u2b96-\\u2b97\\u2bba-\\u2bbc\\u2bc9\\u2bd2-\\u2beb\\u2bf0-\\u2bff\\u2c2f\\u2c5f\\u2cf4-\\u2cf8\\u2d26\\u2d28-\\u2d2c\\u2d2e-\\u2d2f\\u2d68-\\u2d6e\\u2d71-\\u2d7e\\u2d97-\\u2d9f\\u2da7\\u2daf\\u2db7\\u2dbf\\u2dc7\\u2dcf\\u2dd7\\u2ddf\\u2e43-\\u2e7f\\u2e9a\\u2ef4-\\u2eff\\u2fd6-\\u2fef\\u2ffc-\\u3000\\u3040\\u3097-\\u3098\\u3100-\\u3104\\u312e-\\u3130\\u318f\\u31bb-\\u31bf\\u31e4-\\u31ef\\u321f\\u32ff\\u4db6-\\u4dbf\\u9fd6-\\u9fff\\ua48d-\\ua48f\\ua4c7-\\ua4cf\\ua62c-\\ua63f\\ua6f8-\\ua6ff\\ua7ae-\\ua7af\\ua7b8-\\ua7f6\\ua82c-\\ua82f\\ua83a-\\ua83f\\ua878-\\ua87f\\ua8c5-\\ua8cd\\ua8da-\\ua8df\\ua8fe-\\ua8ff\\ua954-\\ua95e\\ua97d-\\ua97f\\ua9ce\\ua9da-\\ua9dd\\ua9ff\\uaa37-\\uaa3f\\uaa4e-\\uaa4f\\uaa5a-\\uaa5b\\uaac3-\\uaada\\uaaf7-\\uab00\\uab07-\\uab08\\uab0f-\\uab10\\uab17-\\uab1f\\uab27\\uab2f\\uab66-\\uab6f\\uabee-\\uabef\\uabfa-\\uabff\\ud7a4-\\ud7af\\ud7c7-\\ud7ca\\ud7fc-\\uf8ff\\ufa6e-\\ufa6f\\ufada-\\ufaff\\ufb07-\\ufb12\\ufb18-\\ufb1c\\ufb37\\ufb3d\\ufb3f\\ufb42\\ufb45\\ufbc2-\\ufbd2\\ufd40-\\ufd4f\\ufd90-\\ufd91\\ufdc8-\\ufdef\\ufdfe-\\ufdff\\ufe1a-\\ufe1f\\ufe53\\ufe67\\ufe6c-\\ufe6f\\ufe75\\ufefd-\\uff00\\uffbf-\\uffc1\\uffc8-\\uffc9\\uffd0-\\uffd1\\uffd8-\\uffd9\\uffdd-\\uffdf\\uffe7\\uffef-\\ufffb\\ufffe-\\uffff]/.test(c))\n\t\t\t\t\t\tescape = 0;\n\t\t\t\t\telse if (code <= 0xff)\n\t\t\t\t\t\tescape = 2;\n\t\t\t\t\telse if (code <= 0xffff)\n\t\t\t\t\t\tescape = 4;\n\t\t\t\t\telse\n\t\t\t\t\t\tescape = 8;\n\n\t\t\t\t\tif (escape === 0)\n\t\t\t\t\t\tresult += c;\n\t\t\t\t\telse if (escape === 2)\n\t\t\t\t\t\tresult += \"\\\\x\" + ul4._lpad(code.toString(16), \"0\", 2);\n\t\t\t\t\telse if (escape === 4)\n\t\t\t\t\t\tresult += \"\\\\u\" + ul4._lpad(code.toString(16), \"0\", 4);\n\t\t\t\t\telse\n\t\t\t\t\t\tresult += \"\\\\U\" + ul4._lpad(code.toString(16), \"0\", 8);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn quote + result + quote;\n\t}\n\n\texport function _lpad( string: string | number, pad: string, len: number ) {\n\t\tif (typeof(string) === \"number\")\n\t\t\tstring = string.toString();\n\t\twhile (string.length < len)\n\t\t\tstring = pad + string;\n\t\treturn string;\n\t}\n\n\texport function _type( obj: any ): string {\n\t\tif (obj === null)\n\t\t\treturn \"none\";\n\t\telse if (obj === false || obj === true)\n\t\t\treturn \"bool\";\n\t\telse if (typeof(obj) === \"undefined\")\n\t\t\treturn \"undefined\";\n\t\telse if (typeof(obj) === \"number\")\n\t\t\treturn Math.round(obj) == obj ? \"int\" : \"float\";\n\t\telse if (typeof(obj) === \"function\")\n\t\t\treturn \"function\";\n\t\telse\n\t\t{\n\t\t\tif (typeof(obj.ul4type) === \"function\")\n\t\t\t\treturn obj.ul4type();\n\t\t\telse\n\t\t\t\treturn ul4.Protocol.get(obj).ul4type();\n\t\t}\n\t}\n\t\n\texport function _rfind( obj: any, sub: any, start: number | null = null, end: number | null = null ) {\n\t\tif (start === null)\n\t\t\tstart = 0;\n\t\tif (end === null)\n\t\t\tend = <number>obj.length;\n\t\tif (start < 0)\n\t\t\tstart += obj.length;\n\t\tif (end < 0)\n\t\t\tend += obj.length;\n\t\tstart = ul4._bound(start, obj.length);\n\t\tend = ul4._bound(end, obj.length);\n\n\t\tif (start !== 0 || end !== obj.length)\n\t\t{\n\t\t\tif (typeof(obj) == \"string\")\n\t\t\t\tobj = obj.substring(start, end);\n\t\t\telse\n\t\t\t\tobj = obj.slice(start, end);\n\t\t}\n\t\tlet result = obj.lastIndexOf(sub);\n\t\tif (result !== -1)\n\t\t\tresult += start;\n\t\treturn result;\n\t}\n\n\texport function _iter( obj: any ): {index: number; next: Function} {\n\t\tif (typeof(obj) === \"string\" || ul4._islist(obj))\n\t\t{\n\t\t\treturn {\n\t\t\t\tindex: 0,\n\t\t\t\tnext: function()\n\t\t\t\t{\n\t\t\t\t\tif (this.index < obj.length)\n\t\t\t\t\t\treturn {value: obj[this.index++], done: false};\n\t\t\t\t\telse\n\t\t\t\t\t\treturn {done: true};\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\telse if (ul4._isiter(obj))\n\t\t\treturn obj;\n\t\telse if (obj !== null && typeof(obj.__iter__) === \"function\")\n\t\t\treturn obj.__iter__();\n\t\telse if (ul4._ismap(obj))\n\t\t{\n\t\t\tlet keys: string[] = [];\n\t\t\tobj.forEach(function(value: string, key: string){\n\t\t\t\tkeys.push(key);\n\t\t\t});\n\t\t\treturn {\n\t\t\t\tindex: 0,\n\t\t\t\tnext: function()\n\t\t\t\t{\n\t\t\t\t\tif (this.index >= keys.length)\n\t\t\t\t\t\treturn {done: true};\n\t\t\t\t\treturn {value: keys[this.index++], done: false};\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\telse if (ul4._isset(obj))\n\t\t{\n\t\t\tlet values: string[] = [];\n\t\t\tobj.forEach(function(value: string, key: string){\n\t\t\t\tvalues.push(value);\n\t\t\t});\n\t\t\treturn {\n\t\t\t\tindex: 0,\n\t\t\t\tnext: function()\n\t\t\t\t{\n\t\t\t\t\tif (this.index >= values.length)\n\t\t\t\t\t\treturn {done: true};\n\t\t\t\t\treturn {value: values[this.index++], done: false};\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\telse if (ul4._isul4set(obj))\n\t\t{\n\t\t\treturn ul4._iter(obj.items);\n\t\t}\n\t\telse if (ul4._isobject(obj))\n\t\t{\n\t\t\tlet keys: string[] = [];\n\t\t\tfor (let key in obj)\n\t\t\t\tkeys.push(key);\n\t\t\treturn {\n\t\t\t\tindex: 0,\n\t\t\t\tnext: function()\n\t\t\t\t{\n\t\t\t\t\tif (this.index >= keys.length)\n\t\t\t\t\t\treturn {done: true};\n\t\t\t\t\treturn {value: keys[this.index++], done: false};\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\tthrow new ul4.TypeError(ul4._type(obj) + \" object is not iterable\");\n\t}\n\n\texport class Proto {\n\t\tpublic __id__: number;\n\n\t\tconstructor() {\n\t\t\tthis.__id__ = _nextid++;\n\t\t}\n\n\t\tul4type() {\n\t\t\treturn this.constructor.name;\n\t\t}\n\n\t\t// equality comparison of objects defaults to identity comparison\n\t\t__eq__( other: any ) {\n\t\t\treturn this === other;\n\t\t}\n\n\t\t// To overwrite equality comparison, you only have to overwrite ``__eq__``,\n\t\t// ``__ne__`` will be synthesized from that\n\t\t__ne__( other: any )\n\t\t{\n\t\t\treturn !this.__eq__(other);\n\t\t}\n\n\t\t// For other comparison operators, each method has to be implemented:\n\t\t// ``<`` calls ``__lt__``, ``<=`` calls ``__le__``, ``>`` calls ``__gt__`` and\n\t\t// ``>=`` calls ``__ge__``\n\n\t\t__bool__()\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t}\n\n\texport class TimeDelta extends Proto {\n\n\t\tprivate _microseconds: number;\n\t\tprivate _seconds: number;\n\t\tprivate _days: number;\n\n\t\tconstructor(days=0, seconds=0, microseconds=0)\n\t\t{\n\t\t\tsuper();\n\t\t\tlet total_microseconds = Math.floor((days * 86400 + seconds)*1000000 + microseconds);\n\n\t\t\tmicroseconds = ul4.ModAST.prototype._do(total_microseconds, 1000000);\n\t\t\tlet total_seconds = Math.floor(total_microseconds / 1000000);\n\t\t\tseconds = ul4.ModAST.prototype._do(total_seconds, 86400);\n\t\t\tdays = Math.floor(total_seconds / 86400);\n\t\t\tif (seconds < 0)\n\t\t\t{\n\t\t\t\tseconds += 86400;\n\t\t\t\t--days;\n\t\t\t}\n\n\t\t\tthis._microseconds = microseconds;\n\t\t\tthis._seconds = seconds;\n\t\t\tthis._days = days;\n\t\t}\n\t}\n\n\texport class Date extends Proto {\n\n\t\tpublic _date: _js_date;\n\n\t\tconstructor( year: number, month: number, day: number ) {\n\t\t\tsuper();\n\t\t\tthis._date = new _js_Date( year, month-1, day );\n\t\t}\n\n\t\tul4type() {\n\t\t\treturn \"date\";\n\t\t}\n\n\t\t__repr__() {\n\t\t\treturn '@(' + this.__str__() + \")\";\n\t\t}\n\n\t\t__str__() {\n\t\t\treturn ul4._lpad(this._date.getFullYear(), \"0\", 4) + \"-\" + ul4._lpad(this._date.getMonth()+1, \"0\", 2) + \"-\" + ul4._lpad(this._date.getDate(), \"0\", 2);\n\t\t}\n\n\t\t__eq__( other: any ) {\n\t\t\tif (other instanceof ul4.Date)\n\t\t\t\treturn this._date.getTime() === other._date.getTime();\n\t\t\treturn false;\n\t\t}\n\n\t\t__lt__( other: any ) {\n\t\t\tif (other instanceof ul4.Date)\n\t\t\t\treturn this._date < other._date;\n\t\t\tul4._unorderable(\"<\", this, other);\n\t\t}\n\n\t\t__le__( other: any ) {\n\t\t\tif (other instanceof ul4.Date)\n\t\t\t\treturn this._date <= other._date;\n\t\t\tul4._unorderable(\"<=\", this, other);\t\n\t\t}\n\n\t\t__gt__( other: any ) {\n\t\t\tif (other instanceof ul4.Date)\n\t\t\t\treturn this._date > other._date;\n\t\t\tul4._unorderable(\">\", this, other);\n\t\t}\n\n\t\t__ge__( other: any ) {\n\t\t\tif (other instanceof ul4.Date)\n\t\t\t\treturn this._date >= other._date;\n\t\t\tul4._unorderable(\">=\", this, other);\n\t\t}\n\n\t\tyear() {\n\t\t\treturn this._date.getFullYear();\n\t\t}\n\n\t\tmonth() {\n\t\t\treturn this._date.getMonth()+1;\n\t\t}\n\n\t\tday() {\n\t\t\treturn this._date.getDate();\n\t\t}\n\t}\n\n\texport class Signature extends Proto {\n\n\t\tpublic args: any[];\n\t\tpublic argNames: any;\n\t\tpublic remargs: any;\n\t\tpublic remkwargs: any;\n\n\t\tconstructor( ...args: any[] ) {\n\t\t\tsuper();\n\t\t\tthis.args = [];\n\t\t\tthis.argNames = {};\n\t\t\tthis.remargs = null;\n\t\t\tthis.remkwargs = null;\n\n\t\t\tlet nextDefault = false;\n\t\t\tlet lastArgname = null;\n\t\t\tfor (let argName of args)\n\t\t\t{\n\t\t\t\tif (nextDefault)\n\t\t\t\t{\n\t\t\t\t\tthis.args.push({name: lastArgname, defaultValue: argName});\n\t\t\t\t\tthis.argNames[lastArgname] = true;\n\t\t\t\t\tnextDefault = false;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (argName.substr(argName.length-1) === \"=\")\n\t\t\t\t\t{\n\t\t\t\t\t\tlastArgname = argName.substr(0, argName.length-1);\n\t\t\t\t\t\tnextDefault = true;\n\t\t\t\t\t}\n\t\t\t\t\telse if (argName.substr(0, 2) === \"**\")\n\t\t\t\t\t\tthis.remkwargs = argName.substr(2);\n\t\t\t\t\telse if (argName.substr(0, 1) === \"*\")\n\t\t\t\t\t\tthis.remargs = argName.substr(1);\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.args.push({name: argName});\n\t\t\t\t\t\tthis.argNames[argName] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Create the argument array for calling a function with this signature with the arguments available from ``args``\n\t\t */\n\t\tbindArray( name: string, args: any[], kwargs: any[] ) {\n\t\t\tlet finalargs = [];\n\t\t\tlet decname = name !== null ? name + \"() \" : \"\";\n\n\t\t\tfor (let i = 0; i < this.args.length; ++i)\n\t\t\t{\n\t\t\t\tlet arg = this.args[i];\n\t\t\t\tif (i < args.length)\n\t\t\t\t{\n\t\t\t\t\tif (kwargs.hasOwnProperty(arg.name))\n\t\t\t\t\t\tthrow new ul4.ArgumentError(decname + \"argument \" + ul4._repr(arg.name) + \" (position \" + i + \") specified multiple times\");\n\t\t\t\t\tfinalargs.push(args[i]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (kwargs.hasOwnProperty(arg.name))\n\t\t\t\t\t\tfinalargs.push(kwargs[arg.name]);\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif (arg.hasOwnProperty(\"defaultValue\"))\n\t\t\t\t\t\t\tfinalargs.push(arg.defaultValue);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new ul4.ArgumentError(\"required \" + decname + \"argument \" + ul4._repr(arg.name) + \" (position \" + i + \") missing\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Do we accept additional positional arguments?\n\t\t\tif (this.remargs === null)\n\t\t\t{\n\t\t\t\t// No, but we have them -> complain\n\t\t\t\tif (args.length > this.args.length)\n\t\t\t\t{\n\t\t\t\t\tlet prefix = name === null ? \"expected\" : name + \"() expects\";\n\t\t\t\t\tthrow new ul4.ArgumentError(prefix + \" at most \" + this.args.length + \" positional argument\" + (this.args.length != 1 ? \"s\" : \"\") + \", \" + args.length + \" given\");\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t// Put additional positional arguments in the call into the ``*`` argument (if there are none, this pushes an empty list)\n\t\t\t\tfinalargs.push(args.slice(this.args.length));\n\t\t\t}\n\n\t\t\t// Do we accept arbitrary keyword arguments?\n\t\t\tif (this.remkwargs === null)\n\t\t\t{\n\t\t\t\t// No => complain about unknown ones\n\t\t\t\tfor (let key in kwargs)\n\t\t\t\t{\n\t\t\t\t\tif (!this.argNames[key])\n\t\t\t\t\t{\n\t\t\t\t\t\tif (name === null)\n\t\t\t\t\t\t\tthrow new ul4.ArgumentError(\"an argument named \" + ul4._repr(key) + \" isn't supported\");\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new ul4.ArgumentError(name + \"() doesn't support an argument named \" + ul4._repr(key));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t// Yes => Put the unknown ones into an object and add that to the arguments array\n\t\t\t\tlet remkwargs = helpers._emptymap();\n\t\t\t\tfor (let key in kwargs)\n\t\t\t\t{\n\t\t\t\t\tif (!this.argNames[key])\n\t\t\t\t\t\thelpers._setmap(remkwargs, key, kwargs[key]);\n\t\t\t\t}\n\t\t\t\tfinalargs.push(remkwargs);\n\t\t\t}\n\n\t\t\treturn finalargs;\n\t\t}\n\t}\n\n\texport abstract class AST extends Proto {\n\t\tprotected pos: any;\n\t\tpublic _ul4onattrs: string[] = [\"pos\"];\n\t\tconstructor( pos: any ) {\n\t\t\tsuper();\n\t\t\tthis.pos = pos;\n\t\t}\n\n\t\t__getattr__(attrname: string)\n\t\t{\n\t\t\tif (attrname === \"type\")\n\t\t\t\treturn this.ul4type;\n\t\t\telse if (this._ul4onattrs.indexOf(attrname) >= 0)\n\t\t\t\treturn (<any>this)[attrname];\n\t\t\tthrow new ul4.AttributeError(this, attrname);\n\t\t}\n\n\t\t__setitem__(attrname: string, value: any) {\n\t\t\tthrow new ul4.TypeError(\"object is immutable\");\n\t\t}\n\n\t\t__str__() {\n\t\t\tlet out: string[] = [];\n\t\t\tthis._str(out);\n\t\t\treturn ul4._formatsource(out);\n\t\t}\n\n\t\t__repr__() {\n\t\t\tlet out: string[] = [];\n\t\t\tthis._repr(out);\n\t\t\treturn ul4._formatsource(out);\n\t\t}\n\n\t\t_handle_eval(context: any) {\n\t\t\ttry\n\t\t\t{\n\t\t\t\t// ? return this._eval(context);\n\t\t\t\treturn this._eval(context);\n\t\t\t}\n\t\t\tcatch (exc)\n\t\t\t{\n\t\t\t\tif (!(exc instanceof ul4.InternalException) && !(exc instanceof ul4.LocationError))\n\t\t\t\t\tthrow new ul4.LocationError(this, exc);\n\t\t\t\tthrow exc;\n\t\t\t}\n\t\t}\n\n\t\t_handle_eval_set(context: any, value: any) {\n\t\t\ttry\n\t\t\t{\n\t\t\t\treturn this._eval_set(context, value);\n\t\t\t}\n\t\t\tcatch (exc)\n\t\t\t{\n\t\t\t\tif (!(exc instanceof ul4.LocationError))\n\t\t\t\t\tthrow new ul4.LocationError(this, exc);\n\t\t\t\tthrow exc;\n\t\t\t}\n\t\t}\n\n\t\t_eval_set(context: any, value: any) {\n\t\t\tthrow new ul4.LValueRequiredError();\n\t\t}\n\n\t\t_handle_eval_modify(context: any, operator: any, value: any) {\n\t\t\ttry\n\t\t\t{\n\t\t\t\treturn this._eval_modify(context, operator, value);\n\t\t\t}\n\t\t\tcatch (exc)\n\t\t\t{\n\t\t\t\tif (!(exc instanceof ul4.LocationError))\n\t\t\t\t\tthrow new ul4.LocationError(this, exc);\n\t\t\t\tthrow exc;\n\t\t\t}\n\t\t}\n\n\t\t_eval_modify(context: any, operator: any, value: any ) {\n\t\t\tthrow new ul4.LValueRequiredError();\n\t\t}\n\n\t\t_repr(out: any) {\n\t\t}\n\n\t\t_str(out: any) {\n\t\t}\n\n\t\tul4ondump( encoder: ul4on.Encoder )\n\t\t{\n\t\t\tfor (let attrname of this._ul4onattrs)\n\t\t\t\tencoder.dump((<any>this)[attrname]);\n\t\t}\n\n\t\tul4onload( decoder: ul4on.Decoder )\n\t\t{\n\t\t\tfor (let attrname of this._ul4onattrs)\n\t\t\t\t(<any>this)[attrname] = decoder.load();\n\t\t}\n\n\t\tabstract _eval( context: any ): any;\n\t}\n\n\texport abstract  class CodeAST extends AST {\n\t\t\n\t\tprivate tag: any;\n\n\t\tconstructor( tag: any, pos: any ) {\n\t\t\tsuper( tag );\n\t\t\tthis.tag = tag;\n\t\t}\n\n\t\t_str( out: any ) {\n\t\t\tout.push(this.tag.source.substring(this.pos.start, this.pos.stop).replace(/\\r?\\n/g, ' '));\n\t\t}\n\t}\n\n\texport class ConstAST extends CodeAST {\n\n\t\tprivate value: any;\n\n\t\tconstructor(tag: any, pos: any, value: any)\n\t\t{\n\t\t\tsuper(tag, pos);\n\t\t\tthis.value = value;\n\t\t}\n\n\t\t_repr(out: any)\n\t\t{\n\t\t\tout.push(\"<ConstAST value=\");\n\t\t\tout.push(ul4._repr(this.value));\n\t\t\tout.push(\">\");\n\t\t}\n\n\t\t_eval(context: any)\n\t\t{\n\t\t\treturn this.value;\n\t\t}\n\t}\n\n\texport abstract class BinaryAST extends CodeAST{\n\n\t\tpublic _ul4onattrs = ul4.AST.prototype._ul4onattrs.concat([\"tag\"]);\n\n\t\tpublic obj1: any;\n\t\tpublic obj2: any;\n\n\t\tconstructor( tag: any, pos: any, obj1: any, obj2: any) {\n\t\t\tsuper(tag, pos);\n\t\t\tthis.obj1 = obj1;\n\t\t\tthis.obj2 = obj2;\n\t\t}\n\n\t\t_repr( out: any ) {\n\t\t\tout.push(\"<\");\n\t\t\tout.push(this.constructor.name);\n\t\t\tout.push(\" obj1=\");\n\t\t\tthis.obj1._repr(out);\n\t\t\tout.push(\" obj2=\");\n\t\t\tthis.obj2._repr(out);\n\t\t\tout.push(\">\");\n\t\t}\n\n\t\t_eval( context: any ) {\n\t\t\tlet obj1 = this.obj1._handle_eval(context);\n\t\t\tlet obj2 = this.obj2._handle_eval(context);\n\t\t\treturn this._do(obj1, obj2);\n\t\t}\n\n\t\tabstract _do( obj1: any, obj2: any ): any;\n\n\t}\n\n\texport class ModAST extends BinaryAST {\n\t\t_do( obj1: any, obj2: any) {\n\t\t\treturn ul4._mod(obj1, obj2);\n\t\t}\n\t\t_ido(obj1: any, obj2: any)\n\t\t{\n\t\t\treturn this._do(obj1, obj2);\n\t\t}\n\t}\n\n\texport class Protocol {\n\t\tpublic static attrs: Set<string> | ul4._Set = helpers._emptyset();\n\t\tpublic static ul4type(): string {\n\t\t\treturn Protocol.constructor.name;\n\t\t}\n\t\t\n\t\tpublic static dir() {\n\t\t}\n\n\t\tpublic static get( obj: any, ...args: any[] ): any {\n\t\t\tif (ul4._isstr( obj ))\n\t\t\t\treturn ul4.StrProtocol;\n\t\t\telse if ( ul4._islist(obj) )\n\t\t\t\treturn ul4.ListProtocol;\n\t\t\telse if ( ul4._isdate(obj) )\n\t\t\t\treturn ul4.DateProtocol;\n\t\t\telse if ( ul4._isset(obj) )\n\t\t\t\treturn ul4.SetProtocol;\n\t\t\telse if ( ul4._ismap(obj) )\n\t\t\t\treturn ul4.MapProtocol;\n\t\t\telse if ( ul4._isdatetime(obj) )\n\t\t\t\treturn ul4.DateTimeProtocol;\n\t\t\telse if ( ul4._isobject(obj) )\n\t\t\t\treturn ul4.ObjectProtocol;\n\t\t\telse\n\t\t\t\treturn ul4.Protocol;\n\t\t}\n\n\t\tpublic static getattr( obj: any, attrname: string) {\n\t\t\tif (obj === null || obj === undefined )\n\t\t\t\tthrow new ul4.AttributeError(obj, attrname);\n\t\t\telse if (typeof(obj.__getattr__) === \"function\")\n\t\t\t\treturn obj.__getattr__(attrname);\n\t\t\telse if ( this.attrs.has( attrname ))\n\t\t\t{\n\t\t\t\tlet attr = (<any>this)[attrname];\n\t\t\t\tlet realattr = new Function(\n\t\t\t\t\t\"return function \" + attr.name + \" (...args: any[]) { return attr.apply(Protocol.attrs, [obj, ...args]); }\"\n\t\t\t\t);\n\t\t\t\t(<any>realattr)._ul4_name = attr._ul4_name || attr.name;\n\t\t\t\t(<any>realattr)._ul4_signature = attr._ul4_signature;\n\t\t\t\t(<any>realattr)._ul4_needsobject = attr._ul4_needsobject;\n\t\t\t\t(<any>realattr)._ul4_needscontext = attr._ul4_needscontext;\n\t\t\t\treturn realattr;\n\t\t\t}\n\t\t\telse\n\t\t\t\tthrow new ul4.AttributeError(obj, attrname);\n\t\t}\n\n\t\tpublic static hasattr( obj: any, attrname: string ): boolean {\n\t\t\tif (obj === null || typeof(obj) === \"undefined\")\n\t\t\t\treturn false;\n\t\t\telse if (typeof(obj.__getattr__) === \"function\")\n\t\t\t{\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\tobj.__getattr__(attrname);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tcatch (exc)\n\t\t\t\t{\n\t\t\t\t\tif (exc instanceof ul4.AttributeError && exc.obj === obj)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\telse\n\t\t\t\t\t\tthrow exc;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t\treturn (<any>this).has(attrname);\n\t\t}\n\t}\n\n\texport class ObjectProtocol extends Protocol {\n\n\t\tpublic static ul4type()\n\t\t{\n\t\t\treturn \"dict\";\n\t\t}\n\n\t\tpublic static getattr(obj: any, attrname: any)\n\t\t{\n\t\t\tlet result: any;\n\t\t\tif (obj && typeof(obj.__getattr__) === \"function\") // test this before the generic object test\n\t\t\t\tresult = obj.__getattr__(attrname);\n\t\t\telse\n\t\t\t\tresult = obj[attrname];\n\t\t\tif (typeof(result) !== \"function\")\n\t\t\t\treturn result;\n\t\t\tlet realresult: any = function(...args: any[]) {\n\t\t\t\t// We can use ``apply`` here, as we know that ``obj`` is a real object.\n\t\t\t\treturn result.apply(obj, args);\n\t\t\t};\n\t\t\trealresult._ul4_name = result._ul4_name || result.name;\n\t\t\trealresult._ul4_signature = result._ul4_signature;\n\t\t\trealresult._ul4_needsobject = result._ul4_needsobject;\n\t\t\trealresult._ul4_needscontext = result._ul4_needscontext;\n\t\t\treturn realresult;\n\t\t}\n\n\t\tpublic static get(obj: any, key: string, default_: any =null): any\n\t\t{\n\t\t\tlet result = obj[key];\n\t\t\tif (typeof(result) === \"undefined\")\n\t\t\t\treturn default_;\n\t\t\treturn result;\n\t\t}\n\n\t\tpublic static items(obj: any)\n\t\t{\n\t\t\tlet result = [];\n\t\t\tfor (let key in obj)\n\t\t\t\tresult.push([key, obj[key]]);\n\t\t\treturn result;\n\t\t}\n\n\t\tpublic static values(obj: any)\n\t\t{\n\t\t\tlet result = [];\n\t\t\tfor (let key in obj)\n\t\t\t\tresult.push(obj[key]);\n\t\t\treturn result;\n\t\t}\n\n\t\tpublic static clear(obj: any)\n\t\t{\n\t\t\tfor (let key in obj)\n\t\t\t\tdelete obj[key];\n\t\t}\n\t}\n\n\tul4.expose(ul4.ObjectProtocol.get, [\"key\", \"default=\", null]);\n\tul4.expose(ul4.ObjectProtocol.items, []);\n\tul4.expose(ul4.ObjectProtocol.values, []);\n\tul4.expose(ul4.ObjectProtocol.clear, []);\n\n\texport class MapProtocol extends Protocol {\n\t\tpublic static ul4type()\n\t\t{\n\t\t\treturn \"dict\";\n\t\t}\n\n\t\tpublic static getattr(obj: any, attrname: string)\n\t\t{\n\t\t\tif (this.attrs.has(attrname))\n\t\t\t{\n\t\t\t\tlet attr = (<any>this)[attrname];\n\t\t\t\tlet realattr: any = function realattr(...args: any[]) {\n\t\t\t\t\treturn attr.apply((<any>this), [obj, ...args]);\n\t\t\t\t};\n\t\t\t\trealattr.name = attr.name;\n\t\t\t\trealattr._ul4_name = attr._ul4_name || attr.name;\n\t\t\t\trealattr._ul4_signature = attr._ul4_signature;\n\t\t\t\trealattr._ul4_needsobject = attr._ul4_needsobject;\n\t\t\t\trealattr._ul4_needscontext = attr._ul4_needscontext;\n\t\t\t\treturn realattr;\n\t\t\t}\n\t\t\telse\n\t\t\t\treturn obj.get(attrname);\n\t\t}\n\n\t\tget(obj: any, key: string, default_: any =null)\n\t\t{\n\t\t\tif (obj.has(key))\n\t\t\t\treturn obj.get(key);\n\t\t\treturn default_;\n\t\t}\n\n\t\titems(obj: any)\n\t\t{\n\t\t\tlet result: any[] = [];\n\t\t\tobj.forEach(function(value: any, key: string){\n\t\t\t\tresult.push([key, value]);\n\t\t\t});\n\t\t\treturn result;\n\t\t}\n\n\t\tvalues(obj: any)\n\t\t{\n\t\t\tlet result: any[] = [];\n\t\t\tobj.forEach(function(value: any, key: string){\n\t\t\t\tresult.push(value);\n\t\t\t});\n\t\t\treturn result;\n\t\t}\n\n\t\tupdate(obj: any, other: any, kwargs: any)\n\t\t{\n\t\t\treturn ul4._update(obj, other, kwargs);\n\t\t}\n\n\t\tclear(obj: any): void\n\t\t{\n\t\t\tobj.clear();\n\t\t\treturn null;\n\t\t}\n\t}\n\n\texport class SetProtocol extends Protocol {\n\n\t\tpublic static attr = helpers._makeset( \"add\", \"clear\" );\n\n\t\tpublic static ul4type()\n\t\t{\n\t\t\treturn \"set\";\n\t\t}\n\n\t\tpublic static add(obj: any, items: string)\n\t\t{\n\t\t\tfor (let item of items)\n\t\t\t\tobj.add(item);\n\t\t}\n\n\t\tpublic static clear( obj: Set<string> | _Set ): void\n\t\t{\n\t\t\tobj.clear();\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tul4.expose(ul4.SetProtocol.add, [\"*items\"]);\n\tul4.expose(ul4.SetProtocol.clear, []);\n\n\texport class DateTimeProtocol extends Protocol {\n\n\t\tpublic static ul4type() {\n\t\t\treturn \"datetime\";\n\t\t}\n\n\t\tpublic static weekday( obj: _js_date ) {\n\t\t\tlet d = obj.getDay();\n\t\t\treturn d ? d-1 : 6;\n\t\t}\n\n\t\tpublic static calendar( obj: _js_date, firstweekday: number = 0, mindaysinfirstweek: number = 4 ) {\n\t\t\t// Normalize parameters\n\t\t\tfirstweekday = ul4._mod(firstweekday, 7);\n\t\t\tif (mindaysinfirstweek < 1)\n\t\t\t\tmindaysinfirstweek = 1;\n\t\t\telse if (mindaysinfirstweek > 7)\n\t\t\t\tmindaysinfirstweek = 7;\n\n\t\t\t// ``obj`` might be in the first week of the next year, or last week of\n\t\t\t// the previous year, so we might have to try those too.\n\t\t\tfor (let offset = +1; offset >= -1; --offset)\n\t\t\t{\n\t\t\t\tlet year = obj.getFullYear() + offset;\n\t\t\t\t// ``refdate`` will always be in week 1\n\t\t\t\tlet refDate = new _js_Date(year, 0, mindaysinfirstweek);\n\t\t\t\t// Go back to the start of ``refdate``s week (i.e. day 1 of week 1)\n\t\t\t\tlet weekDayDiff = ul4._mod(ul4.DateTimeProtocol.weekday(refDate) - firstweekday, 7);\n\t\t\t\tlet weekStartYear = refDate.getFullYear();\n\t\t\t\tlet weekStartMonth = refDate.getMonth();\n\t\t\t\tlet weekStartDay = refDate.getDate() - weekDayDiff;\n\t\t\t\tlet weekStart = new _js_Date(weekStartYear, weekStartMonth, weekStartDay);\n\t\t\t\t// Is our date ``obj`` at or after day 1 of week 1?\n\t\t\t\tif (obj.getTime() >= weekStart.getTime())\n\t\t\t\t{\n\t\t\t\t\tlet diff = ul4.SubAST.prototype._do(obj, weekStart);\n\t\t\t\t\t// Add 1, because the first week is week 1, not week 0\n\t\t\t\t\tlet week = Math.floor(diff.days()/7) + 1;\n\t\t\t\t\treturn [year, week, ul4.DateTimeProtocol.weekday(obj)];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tpublic static week(obj: any, firstweekday: number =0, mindaysinfirstweek: number =4)\n\t\t{\n\t\t\treturn (<any>ul4.DateTimeProtocol.calendar(obj, firstweekday, mindaysinfirstweek))[1];\n\t\t}\n\n\t\tpublic static day(obj: any) {\n\t\t\treturn obj.getDate();\n\t\t}\n\n\t\tpublic static month(obj: any) {\n\t\t\treturn obj.getMonth()+1;\n\t\t}\n\n\t\tpublic static year( obj: any ) {\n\t\t\treturn obj.getFullYear();\n\t\t}\n\n\t\tpublic static hour(obj: any)\n\t\t{\n\t\t\treturn obj.getHours();\n\t\t}\n\n\t\tpublic static minute(obj: any)\n\t\t{\n\t\t\treturn obj.getMinutes();\n\t\t}\n\n\t\tpublic static second(obj: any)\n\t\t{\n\t\t\treturn obj.getSeconds();\n\t\t}\n\n\t\tpublic static microsecond(obj: any) {\n\t\t\treturn obj.getMilliseconds() * 1000;\n\t\t}\n\n\t\tpublic static mimeformat(obj: any) {\n\t\t\tlet weekdayname = [\"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"];\n\t\t\tlet monthname = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\n\n\t\t\treturn weekdayname[ul4.DateTimeProtocol.weekday(obj)] + \", \" + ul4._lpad(obj.getDate(), \"0\", 2) + \" \" + monthname[obj.getMonth()] + \" \" + obj.getFullYear() + \" \" + ul4._lpad(obj.getHours(), \"0\", 2) + \":\" + ul4._lpad(obj.getMinutes(), \"0\", 2) + \":\" + ul4._lpad(obj.getSeconds(), \"0\", 2) + \" GMT\";\n\t\t}\n\n\t\tpublic static isoformat(obj: any) {\n\t\t\tlet year = obj.getFullYear();\n\t\t\tlet month = obj.getMonth()+1;\n\t\t\tlet day = obj.getDate();\n\t\t\tlet hour = obj.getHours();\n\t\t\tlet minute = obj.getMinutes();\n\t\t\tlet second = obj.getSeconds();\n\t\t\tlet ms = obj.getMilliseconds();\n\t\t\tlet result = year + \"-\" + ul4._lpad(month.toString(), \"0\", 2) + \"-\" + ul4._lpad(day.toString(), \"0\", 2) + \"T\" + ul4._lpad(hour.toString(), \"0\", 2) + \":\" + ul4._lpad(minute.toString(), \"0\", 2) + \":\" + ul4._lpad(second.toString(), \"0\", 2);\n\t\t\tif (ms)\n\t\t\t\tresult += \".\" + ul4._lpad(ms.toString(), \"0\", 3) + \"000\";\n\t\t\treturn result;\n\t\t}\n\n\t\tpublic static yearday(obj: any) {\n\t\t\tlet leap = ul4._isleap(obj) ? 1 : 0;\n\t\t\tlet day = obj.getDate();\n\t\t\tswitch (obj.getMonth())\n\t\t\t{\n\t\t\t\tcase 0:\n\t\t\t\t\treturn day;\n\t\t\t\tcase 1:\n\t\t\t\t\treturn 31 + day;\n\t\t\t\tcase 2:\n\t\t\t\t\treturn 31 + 28 + leap + day;\n\t\t\t\tcase 3:\n\t\t\t\t\treturn 31 + 28 + leap + 31 + day;\n\t\t\t\tcase 4:\n\t\t\t\t\treturn 31 + 28 + leap + 31 + 30 + day;\n\t\t\t\tcase 5:\n\t\t\t\t\treturn 31 + 28 + leap + 31 + 30 + 31 + day;\n\t\t\t\tcase 6:\n\t\t\t\t\treturn 31 + 28 + leap + 31 + 30 + 31 + 30 + day;\n\t\t\t\tcase 7:\n\t\t\t\t\treturn 31 + 28 + leap + 31 + 30 + 31 + 30 + 31 + day;\n\t\t\t\tcase 8:\n\t\t\t\t\treturn 31 + 28 + leap + 31 + 30 + 31 + 30 + 31 + 31 + day;\n\t\t\t\tcase 9:\n\t\t\t\t\treturn 31 + 28 + leap + 31 + 30 + 31 + 30 + 31 + 31 + 30 + day;\n\t\t\t\tcase 10:\n\t\t\t\t\treturn 31 + 28 + leap + 31 + 30 + 31 + 30 + 31 + 31 + 30 + 31 + day;\n\t\t\t\tcase 11:\n\t\t\t\t\treturn 31 + 28 + leap + 31 + 30 + 31 + 30 + 31 + 31 + 30 + 31 + 30 + day;\n\t\t\t}\n\t\t}\n\t}\n\n\texport class SubAST extends BinaryAST {\n\n\t\t_do(obj1: any, obj2: any) {\n\t\t\tif (obj1 && typeof(obj1.__sub__) === \"function\")\n\t\t\t\treturn obj1.__sub__(obj2);\n\t\t\telse if (obj2 && typeof(obj2.__rsub__) === \"function\")\n\t\t\t\treturn obj2.__rsub__(obj1);\n\t\t\telse if (ul4._isdate(obj1) && ul4._isdate(obj2))\n\t\t\t\treturn this._date_sub(obj1, obj2);\n\t\t\telse if (ul4._isdatetime(obj1) && ul4._isdatetime(obj2))\n\t\t\t\treturn this._datetime_sub(obj1, obj2);\n\t\t\tif (obj1 === null || obj2 === null)\n\t\t\t\tthrow new ul4.TypeError(ul4._type(this.obj1) + \" - \" + ul4._type(this.obj2) + \" is not supported\");\n\t\t\treturn obj1 - obj2;\n\t\t}\n\n\t\t_date_sub(obj1: any, obj2: any) {\n\t\t\treturn this._datetime_sub(obj1._date, obj2._date);\n\t\t}\n\n\t\t\n\n\t\t_datetime_sub( obj1: any, obj2: any ) {\n\t\t\tlet swap = (obj2 > obj1);\n\n\t\t\tif (swap)\n\t\t\t{\n\t\t\t\tlet t = obj1;\n\t\t\t\tobj1 = obj2;\n\t\t\t\tobj2 = t;\n\t\t\t}\n\t\t\t// From now on obj1 is > than obj2\n\n\t\t\tlet year1 = obj1.getFullYear();\n\t\t\tlet yearday1 = ul4.DateTimeProtocol.yearday(obj1);\n\t\t\tlet year2 = obj2.getFullYear();\n\t\t\tlet yearday2 = ul4.DateTimeProtocol.yearday(obj2);\n\n\t\t\tlet diffdays = 0;\n\n\t\t\twhile (year1 > year2)\n\t\t\t{\n\t\t\t\tdiffdays += ul4.DateProtocol.yearday(ul4._date(year2, 12, 31));\n\t\t\t\t++year2;\n\t\t\t}\n\t\t\tdiffdays += yearday1 - yearday2;\n\n\t\t\tlet hours1 = obj1.getHours();\n\t\t\tlet minutes1 = obj1.getMinutes();\n\t\t\tlet seconds1 = obj1.getSeconds();\n\t\t\tlet hours2 = obj2.getHours();\n\t\t\tlet minutes2 = obj2.getMinutes();\n\t\t\tlet seconds2 = obj2.getSeconds();\n\n\t\t\tlet diffseconds = (seconds1 - seconds2) + 60 * ((minutes1 - minutes2) + 60 * (hours1 - hours2));\n\n\t\t\tlet diffmilliseconds = obj1.getMilliseconds() - obj2.getMilliseconds();\n\n\t\t\tif (swap)\n\t\t\t{\n\t\t\t\tdiffdays = -diffdays;\n\t\t\t\tdiffseconds = -diffseconds;\n\t\t\t\tdiffmilliseconds = -diffmilliseconds;\n\t\t\t}\n\t\t\treturn new ul4.TimeDelta(diffdays, diffseconds, 1000*diffmilliseconds);\n\t\t}\n\n\t}\n\n\texport class DateProtocol extends Protocol {\n\t\t\n\t\tpublic static ul4type() {\n\t\t\treturn \"date\";\n\t\t}\n\n\t\tpublic static weekday( obj: Date ): number {\n\t\t\treturn ul4.DateTimeProtocol.weekday(obj._date);\n\t\t}\n\n\t\tpublic static calendar(obj: any, firstweekday: number =0, mindaysinfirstweek: number =4)\n\t\t{\n\t\t\treturn ul4.DateTimeProtocol.calendar(obj._date, firstweekday, mindaysinfirstweek);\n\t\t}\n\n\t\tpublic static week(obj: any, firstweekday: number =0, mindaysinfirstweek: number =4)\n\t\t{\n\t\t\treturn (<any>ul4.DateProtocol.calendar(obj, firstweekday, mindaysinfirstweek))[1];\n\t\t}\n\n\t\tpublic static day(obj: any)\n\t\t{\n\t\t\treturn obj._date.getDate();\n\t\t}\n\n\t\tpublic static month(obj: any)\n\t\t{\n\t\t\treturn obj._date.getMonth()+1;\n\t\t}\n\n\t\tpublic static  year(obj: any)\n\t\t{\n\t\t\treturn obj._date.getFullYear();\n\t\t}\n\n\t\tpublic static mimeformat(obj: any)\n\t\t{\n\t\t\tlet weekdayname = [\"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"];\n\t\t\tlet monthname = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\n\t\t\tlet d = obj._date;\n\n\t\t\treturn weekdayname[ul4.DateTimeProtocol.weekday(d)] + \", \" + ul4._lpad(d.getDate(), \"0\", 2) + \" \" + monthname[d.getMonth()] + \" \" + d.getFullYear();\n\t\t}\n\n\t\tpublic static isoformat(obj: any)\n\t\t{\n\t\t\tlet d = obj._date;\n\t\t\treturn d.getFullYear() + \"-\" + ul4._lpad((d.getMonth()+1).toString(), \"0\", 2) + \"-\" + ul4._lpad(d.getDate().toString(), \"0\", 2);\n\t\t}\n\n\t\tpublic static yearday(obj: any)\n\t\t{\n\t\t\treturn ul4.DateTimeProtocol.yearday(obj._date);\n\t\t}\n\t}\n\n\texport class ListProtocol extends Protocol {\n\n\t\tpublic static attrs = helpers._makeset(\n\t\t\t\"append\",\n\t\t\t\"insert\",\n\t\t\t\"pop\",\n\t\t\t\"count\",\n\t\t\t\"find\",\n\t\t\t\"rfind\"\n\t\t)\n\n\t\tpublic static ul4type() {\n\t\t\treturn \"list\";\n\t\t}\n\n\t\tpublic static append( obj: any[], items: any[] ): null {\n\t\t\tfor (let item of items)\n\t\t\t\tobj.push(item);\n\t\t\treturn null;\n\t\t}\n\n\t\tpublic static insert( obj: any[], pos: number, items: any[] ): null {\n\t\t\tif (pos < 0)\n\t\t\t\tpos += obj.length;\n\n\t\t\tfor (let item of items)\n\t\t\t\tobj.splice(pos++, 0, item);\n\t\t\treturn null;\n\t\t}\n\n\t\tpublic static pop( obj: any[], pos: number ): any {\n\t\t\tif (pos < 0)\n\t\t\t\tpos += obj.length;\n\n\t\t\tlet result = obj[pos];\n\t\t\tobj.splice(pos, 1);\n\t\t\treturn result;\n\t\t}\n\n\t\tpublic static count( obj: any[], sub: any[], start: number | null = null, end: number | null = null ) {\n\t\t\treturn ul4._count( obj, sub, start, end );\n\t\t}\n\n\t\tpublic static find( obj: any[], sub: any[], start: number | null = null, end: number | null = null ) {\n\t\t\treturn ul4._find(obj, sub, start, end);\n\t\t}\n\n\t\tpublic static rfind( obj: any[], sub: any[], start: number | null = null, end: number | null = null ) {\n\t\t\treturn ul4._rfind(obj, sub, start, end);\n\t\t}\n\t}\n\tul4.expose(ul4.ListProtocol.append, [\"*items\"]);\n\tul4.expose(ul4.ListProtocol.insert, [\"pos\", \"*items\"]);\n\tul4.expose(ul4.ListProtocol.pop, [\"pos=\", -1]);\n\tul4.expose(ul4.ListProtocol.count, [\"sub\", \"start=\", null, \"end=\", null]);\n\tul4.expose(ul4.ListProtocol.find, [\"sub\", \"start=\", null, \"end=\", null]);\n\tul4.expose(ul4.ListProtocol.rfind, [\"sub\", \"start=\", null, \"end=\", null]);\n\n\n\texport class StrProtocol extends Protocol {\n\n\t\tpublic static attrs = helpers._makeset(\n\t\t\t\"split\",\n\t\t\t\"rsplit\",\n\t\t\t\"splitlines\",\n\t\t\t\"strip\",\n\t\t\t\"lstrip\",\n\t\t\t\"rstrip\",\n\t\t\t\"upper\",\n\t\t\t\"lower\",\n\t\t\t\"capitalize\",\n\t\t\t\"startswith\",\n\t\t\t\"endswith\",\n\t\t\t\"replace\",\n\t\t\t\"count\",\n\t\t\t\"find\",\n\t\t\t\"rfind\",\n\t\t\t\"join\"\n\t\t);\n\n\t\tpublic static ul4type() {\n\t\t\treturn \"str\";\n\t\t}\n\n\t\tpublic static count(obj: string, sub: string, start: number | null = null, end: number | null = null ) {\n\t\t\treturn ul4._count(obj, sub, start, end);\n\t\t}\n\n\t\tpublic static find( obj: string, sub: string, start: number | null = null, end: number | null = null ) {\n\t\t\treturn ul4._find( obj, sub, start, end );\n\t\t}\n\n\t\tpublic static rfind( obj: string, sub: string, start: number | null = null, end: number | null = null ) {\n\t\t\treturn ul4._rfind( obj, sub, start, end );\n\t\t}\n\n\t\tpublic static replace( obj: string, old: string, new_: string, count: number | null = null ) {\n\t\t\tif (count === null)\n\t\t\t\tcount = <number>obj.length;\n\n\t\t\tlet result = [];\n\t\t\twhile (obj.length)\n\t\t\t{\n\t\t\t\tlet pos = obj.indexOf(old);\n\t\t\t\tif (pos === -1 || !count--)\n\t\t\t\t{\n\t\t\t\t\tresult.push(obj);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tresult.push(obj.substr(0, pos));\n\t\t\t\tresult.push(new_);\n\t\t\t\tobj = obj.substr(pos + old.length);\n\t\t\t}\n\t\t\treturn result.join(\"\");\n\t\t}\n\n\t\tpublic static strip( obj: string, chars: string | null = null ) {\n\t\t\tchars = chars || \" \\r\\n\\t\";\n\t\t\tif (typeof(chars) !== \"string\")\n\t\t\t\tthrow new ul4.TypeError(\"strip() requires a string argument\");\n\n\t\t\twhile (obj && chars.indexOf(obj[0]) >= 0)\n\t\t\t\tobj = obj.substr(1);\n\t\t\twhile (obj && chars.indexOf(obj[obj.length-1]) >= 0)\n\t\t\t\tobj = obj.substr(0, obj.length-1);\n\t\t\treturn obj;\n\t\t}\n\n\t\tpublic static lstrip( obj: string, chars: string | null = null ) {\n\t\t\tchars = chars || \" \\r\\n\\t\";\n\t\t\tif (typeof(chars) !== \"string\")\n\t\t\t\tthrow new ul4.TypeError(\"lstrip() requires a string argument\");\n\n\t\t\twhile (obj && chars.indexOf(obj[0]) >= 0)\n\t\t\t\tobj = obj.substr(1);\n\t\t\treturn obj;\n\t\t}\n\n\t\tpublic static rstrip( obj: string, chars: string | null = null ) {\n\t\t\tchars = chars || \" \\r\\n\\t\";\n\t\t\tif (typeof(chars) !== \"string\")\n\t\t\t\tthrow new ul4.TypeError(\"rstrip() requires a string argument\");\n\n\t\t\twhile (obj && chars.indexOf(obj[obj.length-1]) >= 0)\n\t\t\t\tobj = obj.substr(0, obj.length-1);\n\t\t\treturn obj;\n\t\t}\n\n\t\tpublic static split( obj: string, sep: string | null = null, count: number | null = null ): string[] {\n\t\t\tif (sep !== null && typeof(sep) !== \"string\")\n\t\t\t\tthrow new ul4.TypeError(\"split() requires a string\");\n\n\t\t\tif (count === null)\n\t\t\t{\n\t\t\t\tlet result = obj.split(sep !== null ? sep : /[ \\n\\r\\t]+/);\n\t\t\t\tif (sep === null)\n\t\t\t\t{\n\t\t\t\t\tif (result.length && !result[0].length)\n\t\t\t\t\t\tresult.splice(0, 1);\n\t\t\t\t\tif (result.length && !result[result.length-1].length)\n\t\t\t\t\t\tresult.splice(-1);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (sep !== null)\n\t\t\t\t{\n\t\t\t\t\tlet result = [];\n\t\t\t\t\twhile (obj.length)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet pos = obj.indexOf(sep);\n\t\t\t\t\t\tif (pos === -1 || !count--)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresult.push(obj);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresult.push(obj.substr(0, pos));\n\t\t\t\t\t\tobj = obj.substr(pos + sep.length);\n\t\t\t\t\t}\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet result = [];\n\t\t\t\t\twhile (obj.length)\n\t\t\t\t\t{\n\t\t\t\t\t\tobj = ul4.StrProtocol.lstrip(obj, null);\n\t\t\t\t\t\tlet part;\n\t\t\t\t\t\tif (!count--)\n\t\t\t\t\t\t\t part = obj; // Take the rest of the string\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tpart = obj.split(/[ \\n\\r\\t]+/, 1)[0];\n\t\t\t\t\t\tif (part.length)\n\t\t\t\t\t\t\tresult.push(part);\n\t\t\t\t\t\tobj = obj.substr(part.length);\n\t\t\t\t\t}\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tpublic static rsplit( obj: string, sep: string | null = null, count: number | null = null ): string[] {\n\t\t\tif (sep !== null && typeof(sep) !== \"string\")\n\t\t\t\tthrow new ul4.TypeError(\"rsplit() requires a string as second argument\");\n\n\t\t\tif (count === null)\n\t\t\t{\n\t\t\t\tlet result = obj.split(sep !== null ? sep : /[ \\n\\r\\t]+/);\n\t\t\t\tif (sep === null)\n\t\t\t\t{\n\t\t\t\t\tif (result.length && !result[0].length)\n\t\t\t\t\t\tresult.splice(0, 1);\n\t\t\t\t\tif (result.length && !result[result.length-1].length)\n\t\t\t\t\t\tresult.splice(-1);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (sep !== null)\n\t\t\t\t{\n\t\t\t\t\tlet result = [];\n\t\t\t\t\twhile (obj.length)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet pos = obj.lastIndexOf(sep);\n\t\t\t\t\t\tif (pos === -1 || !count--)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresult.unshift(obj);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresult.unshift(obj.substr(pos+sep.length));\n\t\t\t\t\t\tobj = obj.substr(0, pos);\n\t\t\t\t\t}\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet result = [];\n\t\t\t\t\twhile (obj.length)\n\t\t\t\t\t{\n\t\t\t\t\t\tobj = ul4.StrProtocol.rstrip(obj);\n\t\t\t\t\t\tlet part;\n\t\t\t\t\t\tif (!count--)\n\t\t\t\t\t\t\t part = obj; // Take the rest of the string\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpart = obj.split(/[ \\n\\r\\t]+/);\n\t\t\t\t\t\t\tpart = part[part.length-1];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (part.length)\n\t\t\t\t\t\t\tresult.unshift(part);\n\t\t\t\t\t\tobj = obj.substr(0, obj.length-part.length);\n\t\t\t\t\t}\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tpublic static splitlines( obj: string, keepends: boolean = false ): string[] {\n\t\t\tlet pos = 0;\n\t\t\tlet lookingAtLineEnd = function lookingAtLineEnd()\n\t\t\t{\n\t\t\t\tlet c = obj[pos];\n\t\t\t\tif (c === '\\n' || c == '\\u000B' || c == '\\u000C' || c == '\\u001C' || c == '\\u001D' || c == '\\u001E' || c == '\\u0085' || c == '\\u2028' || c == '\\u2029')\n\t\t\t\t\treturn 1;\n\t\t\t\tif (c === '\\r')\n\t\t\t\t{\n\t\t\t\t\tif (pos == length-1)\n\t\t\t\t\t\treturn 1;\n\t\t\t\t\tif (obj[pos+1] === '\\n')\n\t\t\t\t\t\treturn 2;\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t};\n\n\t\t\tlet result = [], length = obj.length;\n\n\t\t\tfor ( let pos = 0, startpos = 0;;)\n\t\t\t{\n\t\t\t\tif (pos >= length)\n\t\t\t\t{\n\t\t\t\t\tif (startpos != pos)\n\t\t\t\t\t\tresult.push(obj.substring(startpos));\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t\tlet lineendlen = lookingAtLineEnd();\n\t\t\t\tif (!lineendlen)\n\t\t\t\t\t++pos;\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet endpos = pos + (keepends ? lineendlen : 0);\n\t\t\t\t\tresult.push(obj.substring(startpos, endpos));\n\t\t\t\t\tpos += lineendlen;\n\t\t\t\t\tstartpos = pos;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tpublic static lower( obj: string ): string {\n\t\t\treturn obj.toLowerCase();\n\t\t}\n\n\t\tpublic static upper( obj: string ): string {\n\t\t\treturn obj.toUpperCase();\n\t\t}\n\n\t\tpublic static capitalize( obj: string ) {\n\t\t\tif (obj.length)\n\t\t\t\tobj = obj[0].toUpperCase() + obj.slice(1).toLowerCase();\n\t\t\treturn obj;\n\t\t}\n\n\t\tpublic static join( obj: string, iterable: Iterable<string> ) {\n\t\t\tlet resultlist = [];\n\t\t\tfor (let iter = ul4._iter(iterable);;)\n\t\t\t{\n\t\t\t\tlet item = iter.next();\n\t\t\t\tif (item.done)\n\t\t\t\t\tbreak;\n\t\t\t\tresultlist.push(item.value);\n\t\t\t}\n\t\t\treturn resultlist.join(obj);\n\t\t}\n\n\t\tpublic static startswith( obj: string, prefix: string | string[] ): boolean {\n\t\t\tif (typeof(prefix) === \"string\")\n\t\t\t\treturn obj.substr(0, prefix.length) === prefix;\n\t\t\telse if (ul4._islist(prefix))\n\t\t\t{\n\t\t\t\tfor (let singlepre of prefix)\n\t\t\t\t{\n\t\t\t\t\tif (obj.substr(0, singlepre.length) === singlepre)\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse\n\t\t\t\tthrow new ul4.TypeError(\"startswith() argument must be string\");\n\t\t}\n\n\t\tpublic static endswith( obj: string, suffix: string | string[] ): boolean {\n\t\t\tif (typeof(suffix) === \"string\")\n\t\t\t\treturn obj.substr(obj.length-suffix.length) === suffix;\n\t\t\telse if (ul4._islist(suffix))\n\t\t\t{\n\t\t\t\tfor (let singlesuf of suffix)\n\t\t\t\t{\n\t\t\t\t\tif (obj.substr(obj.length-singlesuf.length) === singlesuf)\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse\n\t\t\t\tthrow new ul4.TypeError(\"endswith() argument must be string or list of strings\");\n\t\t}\n\t}\n\tul4.expose(ul4.StrProtocol.count, [\"sub\", \"start=\", null, \"end=\", null]);\n\tul4.expose(ul4.StrProtocol.find, [\"sub\", \"start=\", null, \"end=\", null]);\n\tul4.expose(ul4.StrProtocol.rfind, [\"sub\", \"start=\", null, \"end=\", null]);\n\tul4.expose(ul4.StrProtocol.replace, [\"old\", \"new\", \"count=\", null]);\n\tul4.expose(ul4.StrProtocol.strip, [\"chars=\", null]);\n\tul4.expose(ul4.StrProtocol.lstrip, [\"chars=\", null]);\n\tul4.expose(ul4.StrProtocol.rstrip, [\"chars=\", null]);\n\tul4.expose(ul4.StrProtocol.split, [\"sep=\", null, \"count=\", null]);\n\tul4.expose(ul4.StrProtocol.rsplit, [\"sep=\", null, \"count=\", null]);\n\tul4.expose(ul4.StrProtocol.splitlines, [\"keepends=\", false]);\n\tul4.expose(ul4.StrProtocol.lower, []);\n\tul4.expose(ul4.StrProtocol.upper, []);\n\tul4.expose(ul4.StrProtocol.capitalize, []);\n\tul4.expose(ul4.StrProtocol.join, [\"iterable\"]);\n\tul4.expose(ul4.StrProtocol.startswith, [\"prefix\"]);\n\tul4.expose(ul4.StrProtocol.endswith, [\"suffix\"]);\n\n\n\texport class _Set{\n\n\t\tpublic items: any;\n\t\tpublic __type__: string = \"set\";\n\n\t\t/**\n\t\t * add items to Set\n\t\t * @param {any[]} items \n\t\t */\n\t\tadd(...items: string[]) {\n\t\t\tfor (let item of items)\n\t\t\t\tthis.items[item] = true;\n\t\t}\n\n\t\tclear() {\n\t\t\tthis. items = {};\n\t\t}\n\n\t\thas( item: string ): boolean {\n\t\t\treturn this.items[item] ? true : false;\n\t\t}\n\t\t__getattr__( attrname: string ) {\n\t\t\tlet self = this;\n\t\t\tswitch (attrname)\n\t\t\t{\n\t\t\t\tcase \"add\":\n\t\t\t\t\treturn ul4.expose([\"*items\"], function add(items: any[]){ self.add(...items); });\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new ul4.AttributeError(this, attrname);\n\t\t\t}\n\t\t}\n\n\t\t__contains__( item: string ) {\n\t\t\treturn this.items[item] || false;\n\t\t}\n\n\t\t__bool__() {\n\t\t\tfor (let item in this.items)\n\t\t\t{\n\t\t\t\tif (!this.items.hasOwnProperty(item))\n\t\t\t\t\tcontinue;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\t\t__repr__() {\n\t\t\tlet v = [];\n\t\t\tv.push(\"{\");\n\t\t\tlet i = 0;\n\t\t\tfor (let item in this.items)\n\t\t\t{\n\t\t\t\tif (!this.items.hasOwnProperty(item))\n\t\t\t\t\tcontinue;\n\t\t\t\tif (i++)\n\t\t\t\t\tv.push(\", \");\n\t\t\t\tv.push(ul4._repr(item));\n\t\t\t}\n\t\t\tif (!i)\n\t\t\t\tv.push(\"/\");\n\t\t\tv.push(\"}\");\n\t\t\treturn v.join(\"\");\n\t\t}\n\n\t\t__eq__( other: any ) {\n\t\t\t// We'll check that everything in ``this`` is in ``other``\n\t\t\t// and if both have the same number of items they are equal\n\t\t\tif (ul4._isset(other))\n\t\t\t{\n\t\t\t\tlet count = 0;\n\t\t\t\tfor (let item in this.items)\n\t\t\t\t{\n\t\t\t\t\tif (!other.has(item))\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t// count the number of items we have\n\t\t\t\t\t++count;\n\t\t\t\t}\n\t\t\t\treturn other.size == count;\n\t\t\t}\n\t\t\telse if (ul4._isul4set(other))\n\t\t\t{\n\t\t\t\tlet count = 0;\n\t\t\t\tfor (let item in this.items)\n\t\t\t\t{\n\t\t\t\t\tif (!other[item])\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t// count the number of items we have\n\t\t\t\t\t++count;\n\t\t\t\t}\n\t\t\t\t// Substract the number of items that ``other`` has\n\t\t\t\tfor (let item in other.items)\n\t\t\t\t\t--count;\n\t\t\t\treturn count == 0;\n\t\t\t}\n\t\t\telse\n\t\t\t\treturn false;\n\t\t}\n\n\t\t__le__( other: any ) {\n\t\t\t// check that ``this`` is a subset of ``other``,\n\t\t\t// i.e. everything in ``this`` is also in ``other``\n\t\t\tif (ul4._isset(other))\n\t\t\t{\n\t\t\t\tlet count = 0;\n\t\t\t\tfor (let item in this.items)\n\t\t\t\t{\n\t\t\t\t\tif (!other.has(item))\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse if (ul4._isul4set(other))\n\t\t\t{\n\t\t\t\tlet count = 0;\n\t\t\t\tfor (let item in this.items)\n\t\t\t\t{\n\t\t\t\t\tif (!other.items[item])\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t\tul4._unorderable(\"<\", this, other);\n\t\t}\n\n\t\t__ge__( other: any ) {\n\t\t\t// check that ``this`` is a superset of ``other``,\n\t\t\t// i.e. everything in ``other`` is also in ``this``\n\t\t\tif (ul4._isset(other))\n\t\t\t{\n\t\t\t\tlet result = true;\n\t\t\t\tother.forEach(function(value: string) {\n\t\t\t\t\tif (!other.items[value])\n\t\t\t\t\t\tresult = false;\n\t\t\t\t});\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\telse if (ul4._isul4set(other))\n\t\t\t{\n\t\t\t\tlet count = 0;\n\t\t\t\tfor (let item in other.items)\n\t\t\t\t{\n\t\t\t\t\tif (!this.items[item])\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t\tul4._unorderable(\"<=\", this, other);\n\t\t}\n\t}\n\texport class slice extends Proto {\n\t\tpublic start: string;\n\t\tpublic stop: string;\n\n\t\tconstructor( start?: string, stop?: string ) {\n\t\t\tsuper();\n\t\t\tthis.start = start;\n\t\t\tthis.stop = stop;\n\t\t}\n\n\t\t__repr__()\n\t\t{\n\t\t\treturn \"slice(\" + ul4._repr(this.start) + \", \" + ul4._repr(this.stop) + \")\";\n\t\t}\n\n\t\t__getattr__(attrname: string)\n\t\t{\n\t\t\tswitch (attrname)\n\t\t\t{\n\t\t\t\tcase \"start\":\n\t\t\t\t\treturn this.start;\n\t\t\t\tcase \"stop\":\n\t\t\t\t\treturn this.stop;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new ul4.AttributeError(this, attrname);\n\t\t\t}\n\t\t}\n\t}\n\n\texport class Context {\n\n\t\tpublic vars: any;\n\t\tpublic indents: any;\n\t\tpublic escapes: any;\n\t\tprivate _output: any;\n\n\t\tconstructor(vars: any)\n\t\t{\n\t\t\tif (vars === null || typeof(vars) === \"undefined\")\n\t\t\t\tvars = {};\n\t\t\tthis.vars = vars;\n\t\t\tthis.indents = [];\n\t\t\tthis.escapes = [];\n\t\t\tthis._output = [];\n\t\t}\n\n\t\t/**\n\t\t *  Return a clone of the ``Context``, but with a fresh empty ``vars`` objects that inherits from the previous one.\n\t\t * This is used by the various comprehensions to avoid leaking loop variables.\n\t\t */\n\t\tinheritvars()\n\t\t{\n\t\t\tlet context = Object.create(this);\n\t\t\tcontext.vars = Object.create(this.vars);\n\t\t\treturn context;\n\t\t}\n\n\t\t/** \n\t\t * Return a clone of the ``Context`` with one additional indentation (this is used by ``RenderAST``) \n\t\t */\n\t\twithindent(indent: any)\n\t\t{\n\t\t\tlet context = Object.create(this);\n\t\t\tif (indent !== null)\n\t\t\t{\n\t\t\t\tcontext.indents = this.indents.slice();\n\t\t\t\tcontext.indents.push(indent);\n\t\t\t}\n\t\t\treturn context;\n\t\t}\n\n\t\t/** \n\t\t * Return a clone of the ``Context`` with the output buffer replaced (this is used by ``renders`` to collect the output in a separate buffer) \n\t\t */\n\t\treplaceoutput()\n\t\t{\n\t\t\tlet context = Object.create(this);\n\t\t\tcontext._output = [];\n\t\t\treturn context;\n\t\t}\n\n\t\tclone(vars: any)\n\t\t{\n\t\t\treturn Object.create(this);\n\t\t}\n\n\t\toutput(value: any)\n\t\t{\n\t\t\tfor (let escape of this.escapes)\n\t\t\t\tvalue = escape(value);\n\t\t\tthis._output.push(value);\n\t\t}\n\n\t\tgetoutput()\n\t\t{\n\t\t\treturn this._output.join(\"\");\n\t\t}\n\n\t\tget(name: string)\n\t\t{\n\t\t\treturn this.vars[name];\n\t\t}\n\n\t\tset(name: string, value: any)\n\t\t{\n\t\t\tthis.vars[name] = value;\n\t\t}\n\t} \n\n\texport class Tag extends AST {\n\n\t\tpublic template: any;\n\t\tpublic tag: any;\n\t\tpublic codepos: number;\n\t\tpublic code: any;\n\t\tpublic text: any;\n\n\t\t_eval(): any{return null};\n\n\t\tconstructor(template: any, tag: any, tagpos: any, codepos: number)\n\t\t{\n\t\t\tsuper(tagpos);\n\t\t\tthis.template = template;\n\t\t\tthis.tag = tag;\n\t\t\tthis.codepos = codepos;\n\t\t}\n\n\t\t__getattr__(attrname: string)\n\t\t{\n\t\t\tswitch (attrname)\n\t\t\t{\n\t\t\t\tcase \"template\":\n\t\t\t\t\treturn this.template;\n\t\t\t\tcase \"tag\":\n\t\t\t\t\treturn this.tag;\n\t\t\t\tcase \"text\":\n\t\t\t\t\treturn this.text;\n\t\t\t\tcase \"code\":\n\t\t\t\t\treturn this.code;\n\t\t\t\tdefault:\n\t\t\t\t\treturn super.__getattr__(attrname);\n\t\t\t}\n\t\t}\n\t}\n\n\tObject.defineProperty(ul4.Tag.prototype, \"text\", {\n\t\tget: function()\n\t\t{\n\t\t\tif (typeof(this.template) !== \"undefined\")\n\t\t\t\treturn this.template.source.substring(this.pos.start, this.pos.stop);\n\t\t\telse\n\t\t\t\treturn null;\n\t\t}\n\t});\n\n\tObject.defineProperty(ul4.Tag.prototype, \"code\", {\n\t\tget: function()\n\t\t{\n\t\t\tif (typeof(this.template) !== \"undefined\")\n\t\t\t\treturn this.template.source.substring(this.codepos.start, this.codepos.stop);\n\t\t\telse\n\t\t\t\treturn null;\n\t\t}\n\t});\n\n\texport class Color extends Proto {\n\n\t\tprivate _r: number;\n\t\tprivate _g: number;\n\t\tprivate _b: number;\n\t\tprivate _a: number;\n\n\t\tconstructor(r=0, g=0, b=0, a=255)\n\t\t{\n\t\t\tsuper();\n\t\t\tthis._r = r;\n\t\t\tthis._g = g;\n\t\t\tthis._b = b;\n\t\t\tthis._a = a;\n\t\t}\n\n\t\t__repr__()\n\t\t{\n\t\t\tlet r = ul4._lpad(this._r.toString(16), \"0\", 2);\n\t\t\tlet g = ul4._lpad(this._g.toString(16), \"0\", 2);\n\t\t\tlet b = ul4._lpad(this._b.toString(16), \"0\", 2);\n\t\t\tlet a = ul4._lpad(this._a.toString(16), \"0\", 2);\n\t\t\tif (this._a !== 0xff)\n\t\t\t{\n\t\t\t\tif (r[0] === r[1] && g[0] === g[1] && b[0] === b[1] && a[0] === a[1])\n\t\t\t\t\treturn \"#\" + r[0] + g[0] + b[0] + a[0];\n\t\t\t\telse\n\t\t\t\t\treturn \"#\" + r + g + b + a;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (r[0] === r[1] && g[0] === g[1] && b[0] === b[1])\n\t\t\t\t\treturn \"#\" + r[0] + g[0] + b[0];\n\t\t\t\telse\n\t\t\t\t\treturn \"#\" + r + g + b;\n\t\t\t}\n\t\t}\n\n\t\t__str__()\n\t\t{\n\t\t\tif (this._a !== 0xff)\n\t\t\t{\n\t\t\t\treturn \"rgba(\" + this._r + \", \" + this._g + \", \" + this._b + \", \" + (this._a/255) + \")\";\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet r = ul4._lpad(this._r.toString(16), \"0\", 2);\n\t\t\t\tlet g = ul4._lpad(this._g.toString(16), \"0\", 2);\n\t\t\t\tlet b = ul4._lpad(this._b.toString(16), \"0\", 2);\n\t\t\t\tlet a = ul4._lpad(this._a.toString(16), \"0\", 2);\n\t\t\t\tif (r[0] === r[1] && g[0] === g[1] && b[0] === b[1])\n\t\t\t\t\treturn \"#\" + r[0] + g[0] + b[0];\n\t\t\t\telse\n\t\t\t\t\treturn \"#\" + r + g + b;\n\t\t\t}\n\t\t}\n\n\t\t__iter__(): any\n\t\t{\n\t\t\treturn {\n\t\t\t\tobj: this,\n\t\t\t\tindex: 0,\n\t\t\t\tnext: function() {\n\t\t\t\t\tif (this.index == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\t++this.index;\n\t\t\t\t\t\treturn {value: this.obj._r, done: false};\n\t\t\t\t\t}\n\t\t\t\t\telse if (this.index == 1)\n\t\t\t\t\t{\n\t\t\t\t\t\t++this.index;\n\t\t\t\t\t\treturn {value: this.obj._g, done: false};\n\t\t\t\t\t}\n\t\t\t\t\telse if (this.index == 2)\n\t\t\t\t\t{\n\t\t\t\t\t\t++this.index;\n\t\t\t\t\t\treturn {value: this.obj._b, done: false};\n\t\t\t\t\t}\n\t\t\t\t\telse if (this.index == 3)\n\t\t\t\t\t{\n\t\t\t\t\t\t++this.index;\n\t\t\t\t\t\treturn {value: this.obj._a, done: false};\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\treturn {done: true};\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t__getattr__(attrname: string)\n\t\t{\n\t\t\tlet self = this;\n\t\t\tswitch (attrname)\n\t\t\t{\n\t\t\t\tcase \"r\":\n\t\t\t\t\tlet r = function r(){ return self._r; };\n\t\t\t\t\tul4.expose(r, []);\n\t\t\t\t\treturn r;\n\t\t\t\tcase \"g\":\n\t\t\t\t\tlet g = function g(){ return self._g; };\n\t\t\t\t\tul4.expose(g, []);\n\t\t\t\t\treturn g;\n\t\t\t\tcase \"b\":\n\t\t\t\t\tlet b = function b(){ return self._b; };\n\t\t\t\t\tul4.expose(b, []);\n\t\t\t\t\treturn b;\n\t\t\t\tcase \"a\":\n\t\t\t\t\tlet a = function a(){ return self._a; };\n\t\t\t\t\tul4.expose(a, []);\n\t\t\t\t\treturn a;\n\t\t\t\tcase \"lum\":\n\t\t\t\t\tlet lum = function lum(){ return self.lum(); };\n\t\t\t\t\tul4.expose(lum, []);\n\t\t\t\t\treturn lum;\n\t\t\t\tcase \"hls\":\n\t\t\t\t\tlet hls = function hls(){ return self.hls(); };\n\t\t\t\t\tul4.expose(hls, []);\n\t\t\t\t\treturn hls;\n\t\t\t\tcase \"hlsa\":\n\t\t\t\t\tlet hlsa = function hlsa(){ return self.hlsa(); };\n\t\t\t\t\tul4.expose(hlsa, []);\n\t\t\t\t\treturn hlsa;\n\t\t\t\tcase \"hsv\":\n\t\t\t\t\tlet hsv = function hsv(){ return self.hsv(); };\n\t\t\t\t\tul4.expose(hsv, []);\n\t\t\t\t\treturn hsv;\n\t\t\t\tcase \"hsva\":\n\t\t\t\t\tlet hsva = function hsva(){ return self.hsva(); };\n\t\t\t\t\tul4.expose(hsva, []);\n\t\t\t\t\treturn hsva;\n\t\t\t\tcase \"witha\":\n\t\t\t\t\tlet witha = function witha(a: any){ return self.witha(a); };\n\t\t\t\t\tul4.expose(witha, [\"a\"]);\n\t\t\t\t\treturn witha;\n\t\t\t\tcase \"withlum\":\n\t\t\t\t\tlet withlum = function withlum(lum: any){ return self.withlum(lum); };\n\t\t\t\t\tul4.expose(withlum, [\"lum\"]);\n\t\t\t\t\treturn withlum;\n\t\t\t\tcase \"abslum\":\n\t\t\t\t\t///@ts-ignore\n\t\t\t\t\tlet abslum = function abslum(lum: any){ return self.abslum(lum); };\n\t\t\t\t\tul4.expose(abslum, [\"lum\"]);\n\t\t\t\t\treturn abslum;\n\t\t\t\tcase \"rellum\":\n\t\t\t\t\t///@ts-ignore\n\t\t\t\t\tlet rellum = function rellum(lum: any){ return self.rellum(lum); };\n\t\t\t\t\tul4.expose(rellum, [\"lum\"]);\n\t\t\t\t\treturn rellum;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new ul4.AttributeError(this, attrname);\n\t\t\t}\n\t\t}\n\n\t\t__getitem__(key: number)\n\t\t{\n\t\t\tlet orgkey = key;\n\t\t\tif (key < 0)\n\t\t\t\tkey += 4;\n\t\t\tswitch (key)\n\t\t\t{\n\t\t\t\tcase 0:\n\t\t\t\t\treturn this._r;\n\t\t\t\tcase 1:\n\t\t\t\t\treturn this._g;\n\t\t\t\tcase 2:\n\t\t\t\t\treturn this._b;\n\t\t\t\tcase 3:\n\t\t\t\t\treturn this._a;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new ul4.IndexError(this, key);\n\t\t\t}\n\t\t}\n\n\t\t__eq__(other: any)\n\t\t{\n\t\t\tif (other instanceof ul4.Color)\n\t\t\t\treturn this._r == other._r && this._g == other._g && this._b == other._b && this._a == other._a;\n\t\t\treturn false;\n\t\t}\n\n\t\tr()\n\t\t{\n\t\t\treturn this._r;\n\t\t}\n\n\t\tg()\n\t\t{\n\t\t\treturn this._g;\n\t\t}\n\n\t\tb()\n\t\t{\n\t\t\treturn this._b;\n\t\t}\n\n\t\ta()\n\t\t{\n\t\t\treturn this._a;\n\t\t}\n\n\t\tlum()\n\t\t{\n\t\t\treturn this.hls()[1];\n\t\t}\n\n\t\thls()\n\t\t{\n\t\t\tlet r = this._r/255.0;\n\t\t\tlet g = this._g/255.0;\n\t\t\tlet b = this._b/255.0;\n\t\t\tlet maxc = Math.max(r, g, b);\n\t\t\tlet minc = Math.min(r, g, b);\n\t\t\tlet h, l, s;\n\t\t\tlet rc, gc, bc;\n\n\t\t\tl = (minc+maxc)/2.0;\n\t\t\tif (minc == maxc)\n\t\t\t\treturn [0.0, l, 0.0];\n\t\t\tif (l <= 0.5)\n\t\t\t\ts = (maxc-minc) / (maxc+minc);\n\t\t\telse\n\t\t\t\ts = (maxc-minc) / (2.0-maxc-minc);\n\t\t\trc = (maxc-r) / (maxc-minc);\n\t\t\tgc = (maxc-g) / (maxc-minc);\n\t\t\tbc = (maxc-b) / (maxc-minc);\n\t\t\tif (r == maxc)\n\t\t\t\th = bc-gc;\n\t\t\telse if (g == maxc)\n\t\t\t\th = 2.0+rc-bc;\n\t\t\telse\n\t\t\t\th = 4.0+gc-rc;\n\t\t\th = (h/6.0) % 1.0;\n\t\t\treturn [h, l, s];\n\t\t}\n\n\t\thlsa()\n\t\t{\n\t\t\tlet hls = this.hls();\n\t\t\treturn hls.concat(this._a/255.0);\n\t\t}\n\n\t\thsv()\n\t\t{\n\t\t\tlet r = this._r/255.0;\n\t\t\tlet g = this._g/255.0;\n\t\t\tlet b = this._b/255.0;\n\t\t\tlet maxc = Math.max(r, g, b);\n\t\t\tlet minc = Math.min(r, g, b);\n\t\t\tlet v = maxc;\n\t\t\tif (minc == maxc)\n\t\t\t\treturn [0.0, 0.0, v];\n\t\t\tlet s = (maxc-minc) / maxc;\n\t\t\tlet rc = (maxc-r) / (maxc-minc);\n\t\t\tlet gc = (maxc-g) / (maxc-minc);\n\t\t\tlet bc = (maxc-b) / (maxc-minc);\n\t\t\tlet h;\n\t\t\tif (r == maxc)\n\t\t\t\th = bc-gc;\n\t\t\telse if (g == maxc)\n\t\t\t\th = 2.0+rc-bc;\n\t\t\telse\n\t\t\t\th = 4.0+gc-rc;\n\t\t\th = (h/6.0) % 1.0;\n\t\t\treturn [h, s, v];\n\t\t}\n\n\t\thsva()\n\t\t{\n\t\t\tlet hsv = this.hsv();\n\t\t\treturn hsv.concat(this._a/255.0);\n\t\t}\n\n\t\twitha(a: number)\n\t\t{\n\t\t\tif (typeof(a) !== \"number\")\n\t\t\t\tthrow new ul4.TypeError(\"witha() requires a number\");\n\t\t\treturn new ul4.Color(this._r, this._g, this._b, a);\n\t\t}\n\n\t\twithlum(lum: any)\n\t\t{\n\t\t\tif (typeof(lum) !== \"number\")\n\t\t\t\tthrow new ul4.TypeError(\"witha() requires a number\");\n\t\t\tlet hlsa = this.hlsa();\n\t\t\treturn ul4._hls(hlsa[0], lum, hlsa[2], hlsa[3]);\n\t\t}\n\n\t\tul4type()\n\t\t{\n\t\t\treturn \"color\";\n\t\t}\n\t}\n\tul4.expose(ul4.Color.prototype.r, []);\n\tul4.expose(ul4.Color.prototype.g, []);\n\tul4.expose(ul4.Color.prototype.b, []);\n\tul4.expose(ul4.Color.prototype.a, []);\n\tul4.expose(ul4.Color.prototype.lum, []);\n\tul4.expose(ul4.Color.prototype.hls, []);\n\tul4.expose(ul4.Color.prototype.hlsa, []);\n\tul4.expose(ul4.Color.prototype.hsv, []);\n\tul4.expose(ul4.Color.prototype.hsva, []);\n\tul4.expose(ul4.Color.prototype.witha, [\"a\"]);\n\tul4.expose(ul4.Color.prototype.withlum, [\"lum\"]);\n\n\texport class MonthDelta extends Proto {\n\t\tprivate _months: number;\n\t\tconstructor( months: number = 0 ) {\n\t\t\tsuper();\n\t\t\tthis._months = months;\n\t\t}\n\t}\n\n\t// --Classes--\n\n\texport class Exception extends Error {\n\t\tpublic cause: any;\n\t\tconstructor( message: string ) {\n\t\t\tsuper( message );\n\t\t\tthis.name = \"UL4 Exception\";\n\t\t}\n\n\t\t/**\n\t\t * \n\t\t * @param attrname \n\t\t * @throws {ul4.AttributeError}\n\t\t */\n\t\tpublic __getattr__( attrname: string ) {\n\t\t\tswitch (attrname)\n\t\t\t{\n\t\t\t\tcase \"cause\":\n\t\t\t\t\treturn this.cause;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new ul4.AttributeError(this, attrname);\n\t\t\t}\n\t\t}\n\t}\n\n\texport class IndexError extends Exception {\n\t\tpublic obj: any;\n\t\tpublic index: any;\n\t\tconstructor(obj: any, index: any)\n\t\t{\n\t\t\tsuper(\"index \" + ul4._repr(index) + \" out of range\");\n\t\t\tthis.obj = obj;\n\t\t\tthis.index = index;\n\t\t}\n\n\t\ttoString()\n\t\t{\n\t\t\treturn \"index \" + this.index + \" out of range for \" + ul4._type(this.obj);\n\t\t}\n\t}\n\texport class SyntaxError extends ul4.Exception{};\n\n\texport class LValueRequiredError extends SyntaxError\n\t{\n\t\tconstructor()\n\t\t{\n\t\t\tsuper(\"lvalue required\");\n\t\t}\n\t}\n\texport class LocationError extends Exception {\n\n\t\tprivate location: any;\n\t\tpublic cause: string;\n\n\t\tconstructor( location: any, cause: string ) {\n\t\t\tsuper( \"nested exception in \" + ul4._repr(location) );\n\t\t\tthis.location = location;\n\t\t\tthis.cause  = cause;\n\n\t\t}\n\t}\n\n\texport class InternalException extends Exception {\n\n\t}\n\n\texport class ArgumentError extends Exception {}\n\n\texport class TypeError extends Exception {};\n\n\texport class AttributeError extends Exception {\n\t\tpublic obj: any;\n\t\tpublic attrname: string;\n\t\tconstructor( obj: any, attrname: string) {\n\t\t\tsuper(\"object of type \" + ul4._type(obj) + \" has no attribute \" + ul4._repr(attrname));\n\t\t\tthis.obj = obj;\n\t\t\tthis.attrname = attrname;\n\t\t}\n\t}\n\n\texport class ValueError extends ul4.Exception {};\n\n}\n\nexport namespace ul4on {\n\t\n\texport let _registry: any = {}\n\n\t/**\n\t * Register the constructor function ``f`` under the name ``name`` with the UL4ON machinery\n\t * @param name \n\t * @param f \n\t */\n\texport function register( name: string, f: Function ) {\n\t\tf.prototype.ul4onname = name;\n\t\t_registry[name] = f;\n\t}\n\n\t/**\n\t * Return a string that contains the object ``obj`` in the UL4ON serialization format\n\t * @param obj \n\t * @param indent \n\t */\n\texport function dumps( obj: any, indent: any ) {\n\t\tlet encoder = new Encoder( indent );\n\t\tencoder.dump( obj );\n\t\treturn encoder.finish();\n\t}\n\n\texport function loads( data: any, registry: any = null ) {\n\t\tlet decoder = new Decoder( data, registry );\n\t\treturn decoder.load();\n\t}\n\n\texport class Encoder {\n\t\tpublic data: any[];\n\t\tpublic indent: any;\n\t\tprivate _level: number;\n\t\tprivate _strings2index: any;\n\t\tprivate _ids2index: any;\n\t\tprivate _backrefs: number;\n\t\t/**\n\t\t * create a new Encoder object\n\t\t * @param ident \n\t\t */\n\t\tconstructor( indent: any = null ) {\n\t\t\tthis.data = [];\n\t\t\tthis._level = 0;\n\t\t\tthis._strings2index = {};\n\t\t\tthis._ids2index = {};\n\t\t\tthis._backrefs = 0;\n\t\t}\n\n\t\tprivate _line( line: string, ...args: any[] ) {\n\t\t\tif( this.indent !== null ) {\n\t\t\t\tfor( let i = 0; i < this._level; ++i )\n\t\t\t\t\tthis.data.push( this.indent );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif( this.data.length )\n\t\t\t\t\tthis.data.push( \" \" );\n\t\t\t}\n\t\t\tthis.data.push( line );\n\n\t\t\tif( args.length ) {\n\t\t\t\tlet oldindent = this.indent;\n\t\t\t\tthis.indent = null;\n\t\t\t\tfor (let arg of args)\n\t\t\t\t\tthis.dump(arg);\n\t\t\t\tthis.indent = oldindent;\n\t\t\t}\n\t\t\tif (this.indent !== null)\n\t\t\t\tthis.data.push(\"\\n\");\n\t\t}\n\n\t\t/**\n\t\t * return the complete string written to the buffer\n\t\t */\n\t\tpublic finish(): string {\n\t\t\treturn this.data.join(\"\");\n\t\t}\n\n\t\tpublic dump( obj: any ) {\n\t\t\tif( obj === null ) {\n\t\t\t\tthis._line( \"n\" );\n\t\t\t}\n\t\t\telse if( typeof( obj ) === \"boolean\" ) {\n\t\t\t\tthis._line(obj ? \"bT\" : \"bF\");\n\t\t\t}\n\t\t\telse if ( typeof( obj ) === \"number\" ) {\n\t\t\t\tlet type: string = (Math.round(obj) == obj) ? \"i\" : \"f\";\n\t\t\t\tthis._line(type + obj);\n\t\t\t}\n\t\t\telse if( typeof( obj ) === \"string\" ) {\n\t\t\t\tlet index = this._strings2index[obj];\n\t\t\t\tif ( typeof( index ) !== \"undefined\" )\n\t\t\t\t{\n\t\t\t\t\tthis._line( \"^\" + index );\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis._strings2index[obj] = this._backrefs++;\n\t\t\t\t\tlet dump = ul4._str_repr( obj ).replace( \"<\", \"\\\\x3c\" );\n\t\t\t\t\tthis._line( \"S\" + dump );\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if( ul4._iscolor( obj ) )\n\t\t\t\tthis._line( \"c\", obj.r(), obj.g(), obj.b(), obj.a() );\n\t\t\telse if ( ul4._isdate( obj ) )\n\t\t\t\tthis._line(\"x\", obj.year(), obj.month(), obj.day() );\n\t\t\telse if ( ul4._isdatetime( obj ) )\n\t\t\t\tthis._line(\"z\", obj.getFullYear(), obj.getMonth()+1, obj.getDate(), obj.getHours(), obj.getMinutes(), obj.getSeconds(), obj.getMilliseconds() * 1000);\n\t\t\telse if ( ul4._istimedelta( obj ) )\n\t\t\t\tthis._line(\"t\", obj.days(), obj.seconds(), obj.microseconds());\n\t\t\telse if ( ul4._ismonthdelta( obj ) )\n\t\t\t\tthis._line(\"m\", obj.months());\n\t\t\telse if ( obj instanceof ul4.slice )\n\t\t\t\tthis._line(\"r\", obj.start, obj.stop );\n\t\t\telse if ( obj.ul4onname && obj.ul4ondump ) {\n\t\t\t\tif ( obj.__id__ ){\n\t\t\t\t\tlet index = this._ids2index[obj.__id__];\n\t\t\t\t\tif ( typeof( index ) != \"undefined\")\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._line( \"^\" + index );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis._ids2index[obj.__id__] = this._backrefs++;\n\t\t\t\t}\n\t\t\t\tthis._line( \"O\", obj.ul4onname );\n\t\t\t\t++this._level;\n\t\t\t\tobj.ul4ondump( this );\n\t\t\t\t--this._level;\n\t\t\t\tthis._line( \")\" );\n\t\t\t}\n\t\t\telse if ( ul4._islist( obj ) ) {\n\t\t\t\tthis._line(\"l\");\n\t\t\t\t++this._level;\n\t\t\t\tfor( let item of obj )\n\t\t\t\t\tthis.dump( item );\n\t\t\t\t--this._level;\n\t\t\t\tthis._line( \"]\" );\n\t\t\t}\n\t\t\telse if ( ul4._ismap( obj ) ) {\n\t\t\t\tthis._line( \"e\" );\n\t\t\t\t++this._level;\n\t\t\t\tfor( let [key, value] of obj.entries() ) {\n\t\t\t\t\tthis.dump( key );\n\t\t\t\t\tthis.dump( value );\n\t\t\t\t}\n\t\t\t\t--this._level;\n\t\t\t\tthis._line( \"}\" );\n\t\t\t}\n\t\t\telse if( ul4._isdict( obj ) ) {\n\t\t\t\tthis._line( \"d\" );\n\t\t\t\t++this._level;\n\t\t\t\tfor ( let key in obj ) {\n\t\t\t\t\tthis.dump( key );\n\t\t\t\t\tthis.dump( obj[key] );\n\t\t\t\t}\n\t\t\t\t--this._level;\n\t\t\t\tthis._line(\"}\");\n\t\t\t}\n\t\t\telse if( ul4._isset( obj ) ) {\n\t\t\t\tthis._line( \"y\" );\n\t\t\t\t++this._level;\n\t\t\t\tfor ( let item of obj.values() )\n\t\t\t\t\tthis.dump(item);\n\t\t\t\t--this._level;\n\t\t\t\tthis._line( \"}\" );\n\t\t\t}\n\t\t\telse \n\t\t\t\tthrow new ul4.ValueError( \"can't create UL4ON dump of object \" + ul4._repr(obj) )\n\t\t}\n\t}\n\n\texport class Decoder {\n\t\t\n\t\tpublic pos: number;\n\t\tpublic backrefs: any[];\n\t\tpublic stack: any[];\n\t\tpublic data: any;\n\t\tpublic registry: any;\n\n\t\tconstructor( data: any, registry: any = null ) {\n\t\t\tthis.data = data || null;\n\t\t\tthis.registry = registry;\n\t\t\tthis.pos = 0;\n\t\t\tthis.backrefs = [];\n\t\t\tthis.stack = []; // Use for informative error messages\n\t\t}\n\n\t\t/**\n\t\t *  Read a character from the buffer (return null on eof)\n\t\t */\n\t\treadchar() {\n\t\t\tif (this.pos >= this.data.length)\n\t\t\t\treturn null;\n\t\t\treturn this.data.charAt(this.pos++);\n\t\t}\n\n\t\treadcharoreof() {\n\t\t\tif (this.pos >= this.data.length)\n\t\t\t\treturn null;\n\t\t\treturn this.data.charAt(this.pos++);\n\t\t}\n\n\t\treadblackchar() {\n\t\t\tlet re_white = /\\s/;\n\n\t\t\tfor (;;)\n\t\t\t{\n\t\t\t\tif (this.pos >= this.data.length)\n\t\t\t\t\tthrow \"UL4 decoder at EOF at position \" + this.pos + \" with path \" + this.stack.join(\"/\");\n\t\t\t\tlet c = this.data.charAt(this.pos++);\n\t\t\t\tif (!c.match(re_white))\n\t\t\t\t\treturn c;\n\t\t\t}\n\t\t}\n\n\t\tread( size: number ) {\n\t\t\tif (this.pos+size > this.data.length)\n\t\t\tsize = this.data.length-this.pos;\n\t\t\tlet result = this.data.substring(this.pos, this.pos+size);\n\t\t\tthis.pos += size;\n\t\t\treturn result;\n\t\t}\n\n\t\tbackup() {\n\t\t\t--this.pos;\n\t\t}\n\n\t\treadnumber(): number {\n\t\t\tlet re_digits = /[-+0123456789.eE]/, value = \"\";\n\t\t\tfor (;;)\n\t\t\t{\n\t\t\t\tlet c = this.readcharoreof();\n\t\t\t\tif (c !== null && c.match(re_digits))\n\t\t\t\t\tvalue += c;\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet result = parseFloat(value);\n\t\t\t\t\tif (isNaN(result))\n\t\t\t\t\t\tthrow \"invalid number, got \" + ul4._repr(\"value\") + \" at position \" + this.pos + \" with path \" + this.stack.join(\"/\");\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t_beginfakeloading()\n\t\t{\n\t\t\tlet oldpos = this.backrefs.length;\n\t\t\tthis.backrefs.push(null);\n\t\t\treturn oldpos;\n\t\t}\n\n\t\t_endfakeloading(oldpos: number, value: any)\n\t\t{\n\t\t\tthis.backrefs[oldpos] = value;\n\t\t}\n\n\t\t_readescape(escapechar: string, length: number)\n\t\t{\n\t\t\tlet chars = this.read(length);\n\t\t\tif (chars.length != length)\n\t\t\t\tthrow \"broken escape \" + ul4._repr(\"\\\\\" + escapechar + chars) + \" at position \" + this.pos + \" with path \" + this.stack.join(\"/\");\n\t\t\tlet codepoint = parseInt(chars, 16);\n\t\t\tif (isNaN(codepoint))\n\t\t\t\tthrow \"broken escape \" + ul4._repr(\"\\\\\" + escapechar + chars) + \" at position \" + this.pos + \" with path \" + this.stack.join(\"/\");\n\t\t\treturn String.fromCharCode(codepoint);\n\t\t}\n\n\t\t/**\n\t\t * Load the next object from the buffer\n\t\t */\n\t \tload(): any {\n\t\t\tlet typecode = this.readblackchar();\n\t\t\tlet result: any;\n\t\t\tswitch (typecode)\n\t\t\t{\n\t\t\t\tcase \"^\":\n\t\t\t\t\treturn this.backrefs[this.readnumber()];\n\t\t\t\tcase \"n\":\n\t\t\t\tcase \"N\":\n\t\t\t\t\tif (typecode === \"N\")\n\t\t\t\t\t\tthis.backrefs.push(null);\n\t\t\t\t\treturn null;\n\t\t\t\tcase \"b\":\n\t\t\t\tcase \"B\":\n\t\t\t\t\tresult = this.readchar();\n\t\t\t\t\tif (result === \"T\")\n\t\t\t\t\t\tresult = true;\n\t\t\t\t\telse if (result === \"F\")\n\t\t\t\t\t\tresult = false;\n\t\t\t\t\telse\n\t\t\t\t\t\tthrow \"wrong value for boolean, expected 'T' or 'F', got \" + ul4._repr(result) + \" at position \" + this.pos + \" with path \" + this.stack.join(\"/\");\n\t\t\t\t\tif (typecode === \"B\")\n\t\t\t\t\t\tthis.backrefs.push(result);\n\t\t\t\t\treturn result;\n\t\t\t\tcase \"i\":\n\t\t\t\tcase \"I\":\n\t\t\t\tcase \"f\":\n\t\t\t\tcase \"F\":\n\t\t\t\t\tresult = this.readnumber();\n\t\t\t\t\tif (typecode === \"I\" || typecode === \"F\")\n\t\t\t\t\t\tthis.backrefs.push(result);\n\t\t\t\t\treturn result;\n\t\t\t\tcase \"s\":\n\t\t\t\tcase \"S\":\n\t\t\t\t\tresult = [];\n\t\t\t\t\tlet delimiter = this.readblackchar();\n\t\t\t\t\tfor (;;)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet c = this.readchar();\n\t\t\t\t\t\tif (c == delimiter)\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tif (c == \"\\\\\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlet c2 = this.readchar();\n\t\t\t\t\t\t\tif (c2 == \"\\\\\")\n\t\t\t\t\t\t\t\tresult.push(\"\\\\\");\n\t\t\t\t\t\t\telse if (c2 == \"n\")\n\t\t\t\t\t\t\t\tresult.push(\"\\n\");\n\t\t\t\t\t\t\telse if (c2 == \"r\")\n\t\t\t\t\t\t\t\tresult.push(\"\\r\");\n\t\t\t\t\t\t\telse if (c2 == \"t\")\n\t\t\t\t\t\t\t\tresult.push(\"\\t\");\n\t\t\t\t\t\t\telse if (c2 == \"f\")\n\t\t\t\t\t\t\t\tresult.push(\"\\u000c\");\n\t\t\t\t\t\t\telse if (c2 == \"b\")\n\t\t\t\t\t\t\t\tresult.push(\"\\u0008\");\n\t\t\t\t\t\t\telse if (c2 == \"a\")\n\t\t\t\t\t\t\t\tresult.push(\"\\u0007\");\n\t\t\t\t\t\t\telse if (c2 == \"'\")\n\t\t\t\t\t\t\t\tresult.push(\"'\");\n\t\t\t\t\t\t\telse if (c2 == '\"')\n\t\t\t\t\t\t\t\tresult.push('\"');\n\t\t\t\t\t\t\telse if (c2 == \"x\")\n\t\t\t\t\t\t\t\tresult.push(this._readescape(\"x\", 2));\n\t\t\t\t\t\t\telse if (c2 == \"u\")\n\t\t\t\t\t\t\t\tresult.push(this._readescape(\"u\", 4));\n\t\t\t\t\t\t\telse if (c2 == \"U\")\n\t\t\t\t\t\t\t\tresult.push(this._readescape(\"U\", 8));\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tresult.push(\"\\\\\" + c2);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tresult.push(c);\n\t\t\t\t\t}\n\t\t\t\t\tresult = result.join(\"\");\n\t\t\t\t\tif (typecode === \"S\")\n\t\t\t\t\t\tthis.backrefs.push(result);\n\t\t\t\t\treturn result;\n\t\t\t\tcase \"c\":\n\t\t\t\tcase \"C\":\n\t\t\t\t\tresult = new ul4.Color();\n\t\t\t\t\tif (typecode === \"C\")\n\t\t\t\t\t\tthis.backrefs.push(result);\n\t\t\t\t\tresult._r = this.load();\n\t\t\t\t\tresult._g = this.load();\n\t\t\t\t\tresult._b = this.load();\n\t\t\t\t\tresult._a = this.load();\n\t\t\t\t\treturn result;\n\t\t\t\tcase \"x\":\n\t\t\t\tcase \"X\":\n\t\t\t\t{\n\t\t\t\t\tlet year = this.load();\n\t\t\t\t\tlet month = this.load();\n\t\t\t\t\tlet day = this.load();\n\t\t\t\t\tresult = new ul4.Date(year, month, day);\n\t\t\t\t\tif (typecode === \"X\")\n\t\t\t\t\t\tthis.backrefs.push(result);\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t\tcase \"z\":\n\t\t\t\tcase \"Z\":\n\t\t\t\t\tresult = new Date();\n\t\t\t\t\tresult.setFullYear(this.load());\n\t\t\t\t\tresult.setDate(1);\n\t\t\t\t\tresult.setMonth(this.load() - 1);\n\t\t\t\t\tresult.setDate(this.load());\n\t\t\t\t\tresult.setHours(this.load());\n\t\t\t\t\tresult.setMinutes(this.load());\n\t\t\t\t\tresult.setSeconds(this.load());\n\t\t\t\t\tresult.setMilliseconds(this.load()/1000);\n\t\t\t\t\tif (typecode === \"Z\")\n\t\t\t\t\t\tthis.backrefs.push(result);\n\t\t\t\t\treturn result;\n\t\t\t\tcase \"t\":\n\t\t\t\tcase \"T\":\n\t\t\t\t\tresult = new ul4.TimeDelta();\n\t\t\t\t\tresult._days = this.load();\n\t\t\t\t\tresult._seconds = this.load();\n\t\t\t\t\tresult._microseconds = this.load();\n\t\t\t\t\tif (typecode === \"T\")\n\t\t\t\t\t\tthis.backrefs.push(result);\n\t\t\t\t\treturn result;\n\t\t\t\tcase \"r\":\n\t\t\t\tcase \"R\":\n\t\t\t\t\tresult = new ul4.slice();\n\t\t\t\t\tif (typecode === \"R\")\n\t\t\t\t\t\tthis.backrefs.push(result);\n\t\t\t\t\tresult.start = this.load();\n\t\t\t\t\tresult.stop = this.load();\n\t\t\t\t\treturn result;\n\t\t\t\tcase \"m\":\n\t\t\t\tcase \"M\":\n\t\t\t\t\tresult = new ul4.MonthDelta();\n\t\t\t\t\tif (typecode === \"M\")\n\t\t\t\t\t\tthis.backrefs.push(result);\n\t\t\t\t\tresult._months = this.load();\n\t\t\t\t\treturn result;\n\t\t\t\tcase \"l\":\n\t\t\t\tcase \"L\":\n\t\t\t\t\tthis.stack.push(\"list\");\n\t\t\t\t\tresult = [];\n\t\t\t\t\tif (typecode === \"L\")\n\t\t\t\t\t\tthis.backrefs.push(result);\n\t\t\t\t\tfor (;;)\n\t\t\t\t\t{\n\t\t\t\t\t\ttypecode = this.readblackchar();\n\t\t\t\t\t\tif (typecode === \"]\")\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tthis.backup();\n\t\t\t\t\t\tresult.push(this.load());\n\t\t\t\t\t}\n\t\t\t\t\tthis.stack.pop();\n\t\t\t\t\treturn result;\n\t\t\t\tcase \"d\":\n\t\t\t\tcase \"D\":\n\t\t\t\tcase \"e\":\n\t\t\t\tcase \"E\":\n\t\t\t\t\tif (!helpers._havemap && (typecode == \"e\" || typecode == \"E\"))\n\t\t\t\t\t\tthrow \"ordered dictionaries are not supported at position \" + this.pos + \" with path \" + this.stack.join(\"/\");\n\t\t\t\t\tresult = helpers._emptymap();\n\t\t\t\t\tthis.stack.push(typecode === \"d\" || typecode === \"D\" ? \"dict\" : \"odict\");\n\t\t\t\t\tif (typecode === \"D\" || typecode === \"E\")\n\t\t\t\t\t\tthis.backrefs.push(result);\n\t\t\t\t\tfor (;;)\n\t\t\t\t\t{\n\t\t\t\t\t\ttypecode = this.readblackchar();\n\t\t\t\t\t\tif (typecode === \"}\")\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tthis.backup();\n\t\t\t\t\t\tlet key = this.load();\n\t\t\t\t\t\tlet value = this.load();\n\t\t\t\t\t\thelpers._setmap(result, key, value);\n\t\t\t\t\t}\n\t\t\t\t\tthis.stack.pop();\n\t\t\t\t\treturn result;\n\t\t\t\tcase \"y\":\n\t\t\t\tcase \"Y\":\n\t\t\t\t\tthis.stack.push(\"set\");\n\t\t\t\t\tresult = helpers._makeset();\n\t\t\t\t\tif (typecode === \"Y\")\n\t\t\t\t\t\tthis.backrefs.push(result);\n\t\t\t\t\tfor (;;)\n\t\t\t\t\t{\n\t\t\t\t\t\ttypecode = this.readblackchar();\n\t\t\t\t\t\tif (typecode === \"}\")\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tthis.backup();\n\t\t\t\t\t\tresult.add(this.load());\n\t\t\t\t\t}\n\t\t\t\t\tthis.stack.pop();\n\t\t\t\t\treturn result;\n\t\t\t\tcase \"o\":\n\t\t\t\tcase \"O\":\n\t\t\t\t{\n\t\t\t\t\tlet oldpos;\n\t\t\t\t\tif (typecode === \"O\")\n\t\t\t\t\t\toldpos = this._beginfakeloading();\n\t\t\t\t\tlet name = this.load();\n\t\t\t\t\tthis.stack.push(name);\n\t\t\t\t\tlet constructor;\n\t\t\t\t\tif (this.registry !== null)\n\t\t\t\t\t{\n\t\t\t\t\t\tconstructor = this.registry[name];\n\t\t\t\t\t\tif (typeof(constructor) === \"undefined\")\n\t\t\t\t\t\t\tconstructor = ul4on._registry[name];\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\tconstructor = ul4on._registry[name];\n\t\t\t\t\tif (typeof(constructor) === \"undefined\")\n\t\t\t\t\t\tthrow new ul4.ValueError(\"can't load object of type \" + ul4._repr(name) + \" at position \" + this.pos + \" with path \" + this.stack.join(\"/\"));\n\t\t\t\t\tresult = new constructor();\n\t\t\t\t\tif (typecode === \"O\")\n\t\t\t\t\t\tthis._endfakeloading(oldpos, result);\n\t\t\t\t\tresult.ul4onload(this);\n\t\t\t\t\ttypecode = this.readblackchar();\n\t\t\t\t\tif (typecode !== \")\")\n\t\t\t\t\t\tthrow new ul4.ValueError(\"object terminator ')' for object of type '\" + name + \"' expected, got \" + ul4._repr(typecode) + \" at position \" + this.pos + \" with path \" + this.stack.join(\"/\"));\n\t\t\t\t\tthis.stack.pop();\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new ul4.ValueError(\"unknown typecode \" + ul4._repr(typecode) + \" at position \" + this.pos + \" with path \" + this.stack.join(\"/\"));\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Return an iterator for loading the content of a object\n\t\t */\n\t\tloadcontent() {\n\t\t\tlet self = this;\n\t\t\treturn {\n\t\t\t\tnext: function()\n\t\t\t\t{\n\t\t\t\t\tlet typecode = self.readblackchar();\n\t\t\t\t\t// Always \"unread\" the typecode even at the end\n\t\t\t\t\t// so that at the end of a call to ul4onload()\n\t\t\t\t\t// the next input is the \"end of object\" marker\n\t\t\t\t\t// no matter whether ul4onload() uses loadcontent() or not.\n\t\t\t\t\tself.backup();\n\t\t\t\t\tif (typecode == \")\")\n\t\t\t\t\t\treturn {done: true};\n\t\t\t\t\telse\n\t\t\t\t\t\treturn {done: false, value: self.load()};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t}\n}"],"names":["helpers","_js_Date","Date","Map","prototype","_havemap","size","error","_haveset","Set","map","key","value","set","ul4","_Set","_i","items","_emptymap","items_3","_c","item","add","_nextid","obj","others","kwargs","_isdict","TypeError","others_1","other","_ismap","forEach","_setmap","_isobject","_islist","other_1","length","h","l","s","a","m1","m2","_v","hue","_rgb","r","g","b","Color","year","month","day","getFullYear","getMonth","out","finalout","level","needlf","out_1","part","push","j","join","obj1","obj2","div","Math","floor","mod","operator","_type","f","signature","options","name","_ul4_name","Signature","_ul4_signature","_ul4_needsobject","needsobject","_ul4_needscontext","needscontext","sub","start","end","_bound","substring","slice","result","indexOf","numbertypes","__eq__","_isdatetime","getTime","i","_eq","hasOwnProperty","has","get","result_1","result_2","result_3","_isset","result_4","upper","_isstr","count","lastIndex","Object","toString","call","TimeDelta","MonthDelta","__proto__","Proto","_repr_internal","ascii","_str_repr","_isdate","_date_repr","_datetime_repr","__repr__","_list_repr","_map_repr","_set_repr","_object_repr","v","i_1","getDate","hour","getHours","minute","getMinutes","second","getSeconds","ms","getMilliseconds","_lpad","date","_date","str","squote","dquote","str_1","c","quote","str_2","code","charCodeAt","escape_1","test","string","pad","len","round","ul4type","Protocol","lastIndexOf","index","next","this","done","_isiter","__iter__","keys_1","values_1","_isul4set","_iter","keys_2","__id__","constructor","days","seconds","microseconds","_super","total_microseconds","ModAST","_do","total_seconds","_this","_microseconds","_seconds","_days","__extends","__str__","_unorderable","args","argNames","remargs","nextDefault","lastArgname","remkwargs","args_1","argName","defaultValue","substr","finalargs","decname","arg","ArgumentError","_repr","prefix","pos","AST","attrname","_ul4onattrs","AttributeError","_str","_formatsource","context","_eval","exc","InternalException","LocationError","_eval_set","LValueRequiredError","_eval_modify","encoder","dump","decoder","load","tag","CodeAST","source","stop","replace","ConstAST","concat","BinaryAST","_handle_eval","_mod","StrProtocol","ListProtocol","DateProtocol","SetProtocol","MapProtocol","DateTimeProtocol","ObjectProtocol","__getattr__","attrs","attr","realattr","Function","_emptyset","realresult","apply","default_","expose","values","clear","attr_1","_update","items_4","_makeset","d","getDay","firstweekday","mindaysinfirstweek","offset","refDate","weekDayDiff","weekday","weekStartYear","weekStartMonth","weekStartDay","weekStart","diff","SubAST","calendar","leap","_isleap","__sub__","__rsub__","_date_sub","_datetime_sub","swap","t","year1","yearday1","yearday","year2","yearday2","diffdays","hours1","minutes1","seconds1","hours2","minutes2","diffseconds","diffmilliseconds","items_5","items_6","splice","_count","_find","_rfind","append","insert","pop","find","rfind","old","new_","chars","sep","split","lstrip","unshift","rstrip","keepends","pos_1","startpos","lineendlen","endpos","toLowerCase","toUpperCase","iterable","resultlist","iter","prefix_1","singlepre","suffix","suffix_1","singlesuf","strip","rsplit","splitlines","lower","capitalize","startswith","endswith","items_7","self","result_5","vars","indents","escapes","_output","Context","create","indent","escape_2","template","tagpos","codepos","Tag","text","defineProperty","_r","_g","_b","_a","lum","hls","hlsa","hsv","hsva","witha","withlum","abslum","rellum","IndexError","rc","gc","bc","maxc","max","minc","min","_hls","months","_months","message","Exception","cause","Error","location","ul4on","ul4onname","_registry","Encoder","finish","data","registry","Decoder","_level","_strings2index","_ids2index","_backrefs","line","oldindent","args_2","_line","type","_iscolor","_istimedelta","_ismonthdelta","ul4ondump","obj_1","_d","entries","_e","ValueError","_h","_f","backrefs","stack","charAt","re_white","match","re_digits","readcharoreof","parseFloat","isNaN","oldpos","escapechar","read","codepoint","parseInt","String","fromCharCode","typecode","readblackchar","readnumber","readchar","delimiter","c2","_readescape","setFullYear","setDate","setMonth","setHours","setMinutes","setSeconds","setMilliseconds","backup","_beginfakeloading","_endfakeloading","ul4onload"],"mappings":"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"}